</script>
<script>
// Auto-fill Department, Portfolio Name, and Portfolio Member Name from localStorage
document.addEventListener('DOMContentLoaded', function() {
    let deptFromQuery = new URLSearchParams(window.location.search).get('department');
    if (deptFromQuery) {
        localStorage.setItem('selectedDepartment', deptFromQuery);
    }
    let dept = deptFromQuery || localStorage.getItem('selectedDepartment') || '';
    let deptFields = document.querySelectorAll("input[name='Department'], input[name='Department:'], select[name='Department'], select[name='Department:']");
    deptFields.forEach(function(field) {
        if (dept) field.value = dept;
        field.required = true;
        field.readOnly = false;
        field.disabled = false;
        if (field.tagName === 'SELECT') {
            field.dispatchEvent(new Event('change', { bubbles: true }));
        }
    });
    let portfolio = localStorage.getItem('selectedPortfolio') || new URLSearchParams(window.location.search).get('portfolio') || '';
    let portfolioFields = document.querySelectorAll("input[name='Portfolio Name'], input[name='Portfolio Name:']");
    portfolioFields.forEach(function(field) {
        if (portfolio) field.value = portfolio;
        field.required = true;
        field.readOnly = false;
        field.disabled = false;
    });
    let member = localStorage.getItem('selectedMemberName') || new URLSearchParams(window.location.search).get('name') || '';
    let memberFields = document.querySelectorAll("input[name='Portfolio Member Name'], input[name='Portfolio Memeber Name']");
    memberFields.forEach(function(field) {
        if (member) field.value = member;
        field.required = true;
        field.readOnly = false;
        field.disabled = false;
    });
    // On submit, forcibly set these values in the form data (never null)
    let form = document.querySelector('form');
    if (form) {
        form.addEventListener('submit', function(e) {
            deptFields.forEach(function(field) { if (!field.value) field.value = dept; });
            portfolioFields.forEach(function(field) { if (!field.value) field.value = portfolio; });
            memberFields.forEach(function(field) { if (!field.value) field.value = member; });
        });
    }
});
</script>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMC Tech Faculty - Form 8</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

            <style>
                .upload-indicator {
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                    margin-top: 0.5rem;
                }
                .upload-indicator span {
                    color: green;
                    font-weight: bold;
                }
                .upload-indicator button {
                    background: #e53e3e;
                    color: white;
                    border: none;
                    border-radius: 0.375rem;
                    padding: 0.25rem 0.75rem;
                    cursor: pointer;
                    font-size: 0.9rem;
                }
                .loading-spinner {
                    border: 2px solid #f3f3f3;
                    border-top: 2px solid #3498db;
                    border-radius: 50%;
                    width: 16px;
                    height: 16px;
                    animation: spin 1s linear infinite;
                    display: inline-block;
                    margin-right: 8px;
                }
                @keyframes spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
                .submit-btn-loading {
                    opacity: 0.7;
                    cursor: not-allowed;
                    pointer-events: none;
                }
            </style>
</head>

    <!-- Footer -->
    <footer class="bg-gray-100 text-center py-4 mt-8 border-t border-gray-300">
        <p class="text-gray-500 text-sm">
            &copy; All Rights Reserved
            <a href="https://pmctech.org" target="_blank" class="text-gray-500 hover:text-gray-700 underline">PMC TECH</a>, IV CSE 2022-2026.<br/>
        </p>
    </footer>

</body>
    <header class="bg-purple-800 text-white flex justify-between items-center px-6 py-3 shadow-md">
        <div class="flex items-center">
            <img src="https://tse1.mm.bing.net/th/id/OIP.paY-ha-IpNQJrH2Lz_JZEgHaDG?w=2560&h=1070&rs=1&pid=ImgDetMain&o=7&rm=3" alt="PMC Logo" class="h-12 rounded shadow-md">
        </div>
    </header>
    <div class="form-container mx-auto max-w-6xl px-4">
    <!-- Main Form -->
    <main>
        <div class="faculty-form-outer">

            <!-- Direct DB Entry: form1-weekly (now replaces header and daily section) -->
            
            <section style="margin: 2rem 0;">
        <h2 class="text-2xl font-bold text-center text-purple-800 tracking-wide mb-6">8. Facilities & Technical support Member (Lab Member)(Weekly)</h2>
        <form id="form8WeeklyForm" class="bg-white shadow-lg rounded-xl max-w-5xl mx-auto px-6 py-8 mb-10 border border-purple-200">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="flex flex-col">
                    <label for="f8w-dept" class="font-semibold text-gray-700 mb-1">Department:</label>
                    <select id="f8w-dept" name="Department" required class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2">
                        <option value="" disabled selected>Select</option>
                        <option value="AERO">AERO</option>
                        <option value="AIDS">AIDS</option>
                        <option value="AIML">AIML</option>
                        <option value="CHEM">CHEM</option>
                        <option value="CIVIL">CIVIL</option>
                        <option value="CSBS">CSBS</option>
                        <option value="CSE">CSE</option>
                        <option value="ECE">ECE</option>
                        <option value="EEE">EEE</option>
                        <option value="IT">IT</option>
                        <option value="MCO">MCO</option>
                        <option value="MECH">MECH</option>
                        <option value="MBA">MBA</option>
                        <option value="MCA">MCA</option>
                        <option value="S&H V1">S&H V1</option>
                        <option value="S&H V2">S&H V2</option>
                        <option value="S&H V3">S&H V3</option>
                        <option value="S&H V4">S&H V4</option>
                        <option value="S&H V5">S&H V5</option>
                        <option value="S&H V6">S&H V6</option>
                    </select>
                </div>
                <div class="flex flex-col">
                    <label for="f8w-portfolio" class="font-semibold text-gray-700 mb-1">Portfolio Name:</label>
                    <input id="f8w-portfolio" name="Portfolio Name" required class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                </div>
                <div class="flex flex-col">
                    <label for="f8w-member" class="font-semibold text-gray-700 mb-1">Portfolio Member Name:</label>
                    <input id="f8w-member" name="Portfolio Member Name" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                </div>
                <div class="flex flex-col">
                    <label for="f8w-month" class="font-semibold text-gray-700 mb-1">Month:</label>
                    <select id="f8w-month" name="Month" required class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2">
                        <option value="" disabled selected>Select</option>
                        <option value="January">January</option>
                        <option value="February">February</option>
                        <option value="March">March</option>
                        <option value="April">April</option>
                        <option value="May">May</option>
                        <option value="June">June</option>
                        <option value="July">July</option>
                        <option value="August">August</option>
                        <option value="September">September</option>
                        <option value="October">October</option>
                        <option value="November">November</option>
                        <option value="December">December</option>
                    </select>
                </div>
                <div class="flex flex-col">
                    <label for="f8w-weekno" class="font-semibold text-gray-700 mb-1">Week no:</label>
                    <input id="f8w-weekno" name="Week no" type="number" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                </div>
                <div class="flex flex-col">
                    <label for="f8w-weekstart" class="font-semibold text-gray-700 mb-1">Week Starting Date:</label>
                    <input id="f8w-weekstart" name="Week Starting Date" type="date" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                </div>
                <div class="flex flex-col">
                    <label for="f8w-weekend" class="font-semibold text-gray-700 mb-1">Week Ending Date:</label>
                    <input id="f8w-weekend" name="Week Ending Date" type="date" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                </div>
            </div>
            <div class="w-full border-t border-gray-200 my-6"></div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">1. Lab Student Entry Register File for all labs</div>
                <div class="flex flex-col">
                    <label for="f8w-status1" class="font-semibold text-gray-700 mb-1">Status_1:</label>
                    <select id="f8w-status1" name="Status_1" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                        <option value="" disabled selected>Select</option>
                        <option>Completed and Updated</option>
                        <option>Yet to be Completed</option>
                        <option>Under Process</option>
                        <option>Not Applicable</option>
                    </select>
                </div>
                <div class="flex flex-col">
                    <label for="f8w-desc1" class="font-semibold text-gray-700 mb-1">Description_1:</label>
                    <input id="f8w-desc1" name="Description_1" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                </div>
                <div class="flex flex-col">
                    <label for="f8w-upload1" class="font-semibold text-gray-700 mb-1">Upload The Scanned File_1:</label>
                    <div class="flex items-center gap-2 w-full">
                        <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                            <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                            <input id="f8w-upload1" name="file1" type="file" class="ml-2 hidden" />
                        </label>
                    </div>
                </div>
            </div>
            <div class="w-full border-t border-gray-200 my-6"></div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">2. Lab Observation and Record audit Report (2 Labs per week)</div>
                <div class="flex flex-col">
                    <label for="f8w-status2" class="font-semibold text-gray-700 mb-1">Status_2:</label>
                    <select id="f8w-status2" name="Status_2" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                        <option value="" disabled selected>Select</option>
                        <option>Completed and Updated</option>
                        <option>Yet to be Completed</option>
                        <option>Under Process</option>
                        <option>Not Applicable</option>
                    </select>
                </div>
                <div class="flex flex-col">
                    <label for="f8w-desc2" class="font-semibold text-gray-700 mb-1">Description_2:</label>
                    <input id="f8w-desc2" name="Description_2" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                </div>
                <div class="flex flex-col">
                    <label for="f8w-upload2" class="font-semibold text-gray-700 mb-1">Upload The Scanned File_2:</label>
                    <div class="flex items-center gap-2 w-full">
                        <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                            <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                            <input id="f8w-upload2" name="file2" type="file" class="ml-2 hidden" />
                        </label>
                    </div>
                </div>
            </div>
            <button type="submit" id="submitBtnWeekly" class="mt-8 bg-purple-800 hover:from-purple-400 hover:to-orange-500 text-white font-bold py-3 px-10 rounded-xl shadow-lg text-lg tracking-wide transition-all duration-200 mx-auto block">Submit</button>
        </form>
            <!-- Direct DB Entry: form4-once in a month -->
            <section style="margin: 2rem 0;">
                <h2 class="text-2xl font-bold text-center text-purple-800 tracking-wide mb-6">8. Facilities & Technical support Member (Lab Member): Once in 3 Months</h2>
                <form id="once3MonthsForm8" class="bg-white shadow-lg rounded-xl max-w-5xl mx-auto px-6 py-8 mb-10 border border-purple-200">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="flex flex-col">
                            <label for="o3m-dept8" class="font-semibold text-gray-700 mb-1">Department:</label>
                            <select id="o3m-dept8" name="Department" required class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option value="AERO">AERO</option>
                                <option value="AIDS">AIDS</option>
                                <option value="AIML">AIML</option>
                                <option value="CHEM">CHEM</option>
                                <option value="CIVIL">CIVIL</option>
                                <option value="CSBS">CSBS</option>
                                <option value="CSE">CSE</option>
                                <option value="ECE">ECE</option>
                                <option value="EEE">EEE</option>
                                <option value="IT">IT</option>
                                <option value="MCO">MCO</option>
                                                                        <option value="MECH">MECH</option>
                                        <option value="MBA">MBA</option>
                                        <option value="MCA">MCA</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-portfolio8" class="font-semibold text-gray-700 mb-1">Portfolio Name:</label>
                            <input id="o3m-portfolio8" name="Portfolio Name" required class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-member8" class="font-semibold text-gray-700 mb-1">Portfolio Member Name:</label>
                            <input id="o3m-member8" name="Portfolio Member Name" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-month8" class="font-semibold text-gray-700 mb-1">Month:</label>
                            <select id="o3m-month8" name="Month" required class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="March">March</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="August">August</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-weekno8" class="font-semibold text-gray-700 mb-1">Week no:</label>
                            <input id="o3m-weekno8" name="Week no" type="number" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-weekstart8" class="font-semibold text-gray-700 mb-1">Week Starting Date:</label>
                            <input id="o3m-weekstart8" name="Week Starting Date" type="date" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-weekend8" class="font-semibold text-gray-700 mb-1">Week Ending Date:</label>
                            <input id="o3m-weekend8" name="Week Ending Date" type="date" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">1. Non-Teaching Faculty File</div>
                        <div class="flex flex-col">
                            <label for="o3m-status1" class="font-semibold text-gray-700 mb-1">Status_1:</label>
                            <select id="o3m-status1" name="Status_1" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-desc1" class="font-semibold text-gray-700 mb-1">Description_1:</label>
                            <input id="o3m-desc1" name="Description_1" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-upload1" class="font-semibold text-gray-700 mb-1">Upload The Scanned File_1:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input id="o3m-upload1" name="file1" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">2. Non-Teaching Faculty Training File</div>
                        <div class="flex flex-col">
                            <label for="o3m-status2" class="font-semibold text-gray-700 mb-1">Status_2:</label>
                            <select id="o3m-status2" name="Status_2" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-desc2" class="font-semibold text-gray-700 mb-1">Description_2:</label>
                            <input id="o3m-desc2" name="Description_2" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-upload2" class="font-semibold text-gray-700 mb-1">Upload The Scanned File_2:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input id="o3m-upload2" name="file2" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <button type="submit" id="submitBtn3Months" class="mt-8 bg-purple-800 hover:from-purple-400 hover:to-orange-500 text-white font-bold py-3 px-10 rounded-xl shadow-lg text-lg tracking-wide transition-all duration-200 mx-auto block">Submit</button>
                </form>
            </section>
            <!-- Direct DB Entry: form3-once in a semester -->
            <section style="margin: 2rem 0;">
                <h2 class="text-2xl font-bold text-center text-purple-800 tracking-wide mb-6">8.Facilities & Technical support Member (Lab Member): Once in a Semester</h2>
                <form id="semesterForm4" class="bg-white shadow-lg rounded-xl max-w-5xl mx-auto px-6 py-8 mb-10 border border-purple-200">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Department:</label>
                            <select name="Department" required class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option value="AERO">AERO</option>
                                <option value="AIDS">AIDS</option>
                                <option value="AIML">AIML</option>
                                <option value="CHEM">CHEM</option>
                                <option value="CIVIL">CIVIL</option>
                                <option value="CSBS">CSBS</option>
                                <option value="CSE">CSE</option>
                                <option value="ECE">ECE</option>
                                <option value="EEE">EEE</option>
                                <option value="IT">IT</option>
                                <option value="MCO">MCO</option>
                                                                        <option value="MECH">MECH</option>
                                        <option value="MBA">MBA</option>
                                        <option value="MCA">MCA</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Portfolio Name:</label>
                            <input name="Portfolio Name" required class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Portfolio Memeber Name:</label>
                            <input name="Portfolio Memeber Name" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Month:</label>
                            <select name="Month" required class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="March">March</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="August">August</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Week no:</label>
                            <input name="Week no" type="number" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Week Starting Date:</label>
                            <input name="Week Starting Date" type="date" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Week Ending Date:</label>
                            <input name="Week Ending Date" type="date" class="rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 px-3 py-2" />
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <!-- 8 status/desc/file blocks -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">1. List of Equipment's File for all Labs </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Status_1:</label>
                            <select name="Status_1" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Description_1:</label>
                            <input name="Description_1" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Upload The Scanned File_1:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input name="file1" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">2. Lab manual, Master Lab Manual with Readings Sample Observations & Records</div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Status_2:</label>
                            <select name="Status_2" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Description_2:</label>
                            <input name="Description_2" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Upload The Scanned File_2:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input name="file2" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">3. Stock Register</div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Status_3:</label>
                            <select name="Status_3" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Description_3:</label>
                            <input name="Description_3" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Upload The Scanned File_3:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input name="file3" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">4. Maintenance Register</div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Status_4:</label>
                            <select name="Status_4" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Description_4:</label>
                            <input name="Description_4" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Upload The Scanned File_4:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input name="file4" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">5. Calibration Register</div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Status_5:</label>
                            <select name="Status_5" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Description_5:</label>
                            <input name="Description_5" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Upload The Scanned File_5:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input name="file5" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">6. Infrastructure File (Lab, Class, Seminar, Hall Details with Geotag Photo)</div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Status_6:</label>
                            <select name="Status_6" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Description_6:</label>
                            <input name="Description_6" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Upload The Scanned File_6:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input name="file6" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">7. New Lab Facility Created File</div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Status_7:</label>
                            <select name="Status_7" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Description_7:</label>
                            <input name="Description_7" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Upload The Scanned File_7:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input name="file7" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="w-full border-t border-gray-200 my-6"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">8. Library Book requirements File</div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Status_8:</label>
                            <select name="Status_8" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Description_8:</label>
                            <input name="Description_8" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Upload The Scanned File_8:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input name="file8" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="col-span-1 sm:col-span-2 lg:col-span-4 bg-orange-400 text-white font-bold text-lg rounded-lg px-6 py-2 mb-2 shadow flex items-center">9. Department Library File</div>
                        <div class="flex flex-col">
                            <label for="o3m-status9" class="font-semibold text-gray-700 mb-1">Status_9:</label>
                            <select id="o3m-status9" name="Status_9" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2">
                                <option value="" disabled selected>Select</option>
                                <option>Completed and Updated</option>
                                <option>Yet to be Completed</option>
                                <option>Under Process</option>
                                <option>Not Applicable</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label for="o3m-desc9" class="font-semibold text-gray-700 mb-1">Description_9:</label>
                            <input id="o3m-desc9" name="Description_9" class="rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 px-3 py-2" />
                        </div>
                        <div class="flex flex-col">
                            <label class="font-semibold text-gray-700 mb-1">Upload The Scanned File_9:</label>
                            <div class="flex items-center gap-2 w-full">
                                <label class="flex items-center gap-2 cursor-pointer bg-white hover:bg-gray-100 px-3 py-2 rounded-lg border border-gray-300 transition font-medium text-gray-700">
                                    <span class="inline-flex items-center gap-1">Upload <img src="/static/img/upload.svg" alt="upload" height="20" width="24" class="inline-block align-middle" /></span>
                                    <input id="o3m-upload9" name="file9" type="file" class="ml-2 hidden" />
                                </label>
                            </div>
                        </div>
                    </div>
                    <button type="submit" id="submitBtnSemester" class="mt-8 bg-purple-800 hover:from-purple-400 hover:to-orange-500 text-white font-bold py-3 px-10 rounded-xl shadow-lg text-lg tracking-wide transition-all duration-200 mx-auto block">Submit</button>
                </form>
            </section>
    <!-- Removed: 2. Class Advisor Form: Weekly -->
                    </main>
            </section>

        <!-- NEW: Direct DB Entry: form2-once in a month -->
    <!-- Removed: 2. Class Advisor Form: Once in a Month -->
        <!-- NEW: Direct DB Entry: form2-weekly -->
         
            <!-- ONCE IN A MONTH Section -->

            <!-- ONCE IN A SEMESTER Section -->
    <!-- Removed: 2. Class Advisor Form: Once in a Semester -->
        </div>
    </main>

    </body>

        <script src="https://unpkg.com/@supabase/supabase-js"></script>
        <script>
        // All logic after DOMContentLoaded and after Supabase script is loaded
        window.addEventListener('DOMContentLoaded', function() {
            // Prefill Department and Portfolio Name fields from localStorage for all forms (faculty_form1.html style)
            var dept = localStorage.getItem('selectedDept') || localStorage.getItem('selectedDepartment');
            var portfolio = localStorage.getItem('selectedPortfolio');
            // For all forms on this page
            var formIds = ['form8WeeklyForm', 'once3MonthsForm8', 'semesterForm4'];
            formIds.forEach(function(formId) {
                var form = document.getElementById(formId);
                if (!form) return;
                // Department
                var deptSelect = form.querySelector("select[name='Department']");
                if (dept && deptSelect) {
                    for (var i = 0; i < deptSelect.options.length; i++) {
                        if (deptSelect.options[i].value === dept) {
                            deptSelect.selectedIndex = i;
                            // Trigger change event for listeners
                            deptSelect.dispatchEvent(new Event('change', { bubbles: true }));
                            break;
                        }
                    }
                }
                // Portfolio Name
                var portfolioInput = form.querySelector("input[name='Portfolio Name']");
                if (portfolio && portfolioInput) {
                    portfolioInput.value = portfolio;
                }
            });
            if (window.supabase) {
                const supabaseClient = window.supabase.createClient(
                    "https://cbhodgwaazmjszkujrti.supabase.co",
                    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiaG9kZ3dhYXptanN6a3VqcnRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2NzY4NzEsImV4cCI6MjA3MTI1Mjg3MX0.sBRdfiWJJmZtLWsHCcNyxm1VcwkGwZWsIeeMlS49XTU"
                );
                // --- FACULTY FORM 8 - WEEKLY LOGIC ---
                const form8WeeklyForm = document.getElementById('form8WeeklyForm');
                if (form8WeeklyForm) {
                    form8WeeklyForm.addEventListener('submit', async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const submitBtn = document.getElementById('submitBtnWeekly');
                        
                        // Prevent multiple submissions and show loading
                        if (submitBtn.classList.contains('submit-btn-loading')) return;
                        submitBtn.classList.add('submit-btn-loading');
                        const originalText = submitBtn.innerHTML;
                        submitBtn.innerHTML = '<div class="loading-spinner"></div>Submitting...';
                        
                        async function uploadFileToStorage(file, path) {
                            if (!file) return null;
                            const bucket = 'form8-files';
                            const { data, error } = await supabaseClient.storage.from(bucket).upload(path, file, { upsert: true });
                            if (error) {
                                window.location.href = 'notification.html?status=error&msg=' + encodeURIComponent(error.message);
                                throw error;
                            }
                            const { data: publicUrlData, error: urlError } = supabaseClient.storage.from(bucket).getPublicUrl(path);
                            if (urlError) {
                                window.location.href = 'notification.html?status=error&msg=' + encodeURIComponent(urlError.message);
                                throw urlError;
                            }
                            return publicUrlData.publicUrl;
                        }

                        const ts = Date.now();
                        let file1Url = null, file2Url = null;
                        try {
                            const file1 = form.querySelector("input[name='file1']")?.files?.[0] || null;
                            if (file1) file1Url = await uploadFileToStorage(file1, `file1/${ts}_${file1.name}`);
                            const file2 = form.querySelector("input[name='file2']")?.files?.[0] || null;
                            if (file2) file2Url = await uploadFileToStorage(file2, `file2/${ts}_${file2.name}`);
                        } catch (uploadErr) {
                            return;
                        }

                        const row = {
                            "Department": form["Department"].value,
                            "Portfolio Name": form["Portfolio Name"].value,
                            "Portfolio Member Name": form["Portfolio Member Name"].value,
                            "Month": form["Month"].value,
                            "Week no": form["Week no"].value ? parseInt(form["Week no"].value) : null,
                            "Week Starting Date": form["Week Starting Date"].value || null,
                            "Week Ending Date": form["Week Ending Date"].value || null,
                            "Status_1": form["Status_1"].value,
                            "Description_1": form["Description_1"].value,
                            "Upload The Scanned File_1": file1Url,
                            "Status_2": form["Status_2"].value,
                            "Description_2": form["Description_2"].value,
                            "Upload The Scanned File_2": file2Url
                        };
                        const { data, error } = await supabaseClient
                            .from('form8-weekly')
                            .insert([row]);
                        if (error) {
                            submitBtn.classList.remove('submit-btn-loading');
                            submitBtn.innerHTML = originalText;
                            window.location.href = 'notification.html?status=error&msg=' + encodeURIComponent(error.message);
                        } else {
                            window.location.href = 'notification.html?status=success';
                            form.reset();
                        }
                    });
                }
                // NEW: Once in a Month form4 logic
                const once3MonthsForm8 = document.getElementById('once3MonthsForm8');
                if (once3MonthsForm8) {
                    once3MonthsForm8.addEventListener('submit', async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const submitBtn = document.getElementById('submitBtn3Months');
                        
                        // Prevent multiple submissions and show loading
                        if (submitBtn.classList.contains('submit-btn-loading')) return;
                        submitBtn.classList.add('submit-btn-loading');
                        const originalText = submitBtn.innerHTML;
                        submitBtn.innerHTML = '<div class="loading-spinner"></div>Submitting...';
                        
                        async function uploadFileToStorage(file, path) {
                            if (!file) return null;
                            const bucket = 'form8-files';
                            const { data, error } = await supabaseClient.storage.from(bucket).upload(path, file, { upsert: true });
                            if (error) {
                                window.location.href = 'notification.html?status=error&msg=' + encodeURIComponent(error.message);
                                throw error;
                            }
                            const { data: publicUrlData, error: urlError } = supabaseClient.storage.from(bucket).getPublicUrl(path);
                            if (urlError) {
                                window.location.href = 'notification.html?status=error&msg=' + encodeURIComponent(urlError.message);
                                throw urlError;
                            }
                            return publicUrlData.publicUrl;
                        }

                        const ts = Date.now();
                        let file1Url = null, file2Url = null;
                        try {
                            const file1 = form.querySelector("input[name='file1']")?.files?.[0] || null;
                            if (file1) file1Url = await uploadFileToStorage(file1, `file1/${ts}_${file1.name}`);
                            const file2 = form.querySelector("input[name='file2']")?.files?.[0] || null;
                            if (file2) file2Url = await uploadFileToStorage(file2, `file2/${ts}_${file2.name}`);
                        } catch (uploadErr) {
                            return;
                        }

                        const row = {
                            "Department": form["Department"].value,
                            "Portfolio Name": form["Portfolio Name"].value,
                            "Portfolio Memeber Name": form["Portfolio Memeber Name"].value,
                            "Month": form["Month"].value,
                            "Week no": form["Week no"].value ? parseInt(form["Week no"].value) : null,
                            "Week Starting Date": form["Week Starting Date"].value || null,
                            "Week Ending Date": form["Week Ending Date"].value || null,
                            "Status_1": form["Status_1"].value,
                            "Description_1": form["Description_1"].value,
                            "Upload The Scanned File_1": file1Url,
                            "Status_2": form["Status_2"].value,
                            "Description_2": form["Description_2"].value,
                            "Upload The Scanned File_2": file2Url
                        };
                        const { data, error } = await supabaseClient
                            .from('form8-once in 3 Months')
                            .insert([row]);
                        if (error) {
                            submitBtn.classList.remove('submit-btn-loading');
                            submitBtn.innerHTML = originalText;
                            window.location.href = 'notification.html?status=error&msg=' + encodeURIComponent(error.message);
                        } else {
                            window.location.href = 'notification.html?status=success';
                            form.reset();
                        }
                    });
                }
                // NEW: Semester form logic
                const semesterDbForm = document.getElementById('semesterDbForm');
                // --- FACULTY FORM 8 - ONCE IN A SEMESTER LOGIC ---
                const semesterForm4 = document.getElementById('semesterForm4');
                if (semesterForm4) {
                    semesterForm4.addEventListener('submit', async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const submitBtn = document.getElementById('submitBtnSemester');
                        
                        // Prevent multiple submissions and show loading
                        if (submitBtn.classList.contains('submit-btn-loading')) return;
                        submitBtn.classList.add('submit-btn-loading');
                        const originalText = submitBtn.innerHTML;
                        submitBtn.innerHTML = '<div class="loading-spinner"></div>Submitting...';
                        
                        async function uploadFileToStorage(file, path) {
                            if (!file) return null;
                            const bucket = 'form8-files';
                            const { data, error } = await supabaseClient.storage.from(bucket).upload(path, file, { upsert: true });
                            if (error) {
                                window.location.href = 'notification.html?status=error&msg=' + encodeURIComponent(error.message);
                                throw error;
                            }
                            const { data: publicUrlData, error: urlError } = supabaseClient.storage.from(bucket).getPublicUrl(path);
                            if (urlError) {
                                window.location.href = 'notification.html?status=error&msg=' + encodeURIComponent(urlError.message);
                                throw urlError;
                            }
                            return publicUrlData.publicUrl;
                        }
                        const ts = Date.now();
                        let file1Url = null, file2Url = null, file3Url = null, file4Url = null, file5Url = null, file6Url = null, file7Url = null, file8Url = null, file9Url = null;
                        try {
                            const file1 = form.querySelector("input[name='file1']")?.files?.[0] || null;
                            if (file1) file1Url = await uploadFileToStorage(file1, `file1/${ts}_${file1.name}`);
                            const file2 = form.querySelector("input[name='file2']")?.files?.[0] || null;
                            if (file2) file2Url = await uploadFileToStorage(file2, `file2/${ts}_${file2.name}`);
                            const file3 = form.querySelector("input[name='file3']")?.files?.[0] || null;
                            if (file3) file3Url = await uploadFileToStorage(file3, `file3/${ts}_${file3.name}`);
                            const file4 = form.querySelector("input[name='file4']")?.files?.[0] || null;
                            if (file4) file4Url = await uploadFileToStorage(file4, `file4/${ts}_${file4.name}`);
                            const file5 = form.querySelector("input[name='file5']")?.files?.[0] || null;
                            if (file5) file5Url = await uploadFileToStorage(file5, `file5/${ts}_${file5.name}`);
                            const file6 = form.querySelector("input[name='file6']")?.files?.[0] || null;
                            if (file6) file6Url = await uploadFileToStorage(file6, `file6/${ts}_${file6.name}`);
                            const file7 = form.querySelector("input[name='file7']")?.files?.[0] || null;
                            if (file7) file7Url = await uploadFileToStorage(file7, `file7/${ts}_${file7.name}`);
                            const file8 = form.querySelector("input[name='file8']")?.files?.[0] || null;
                            if (file8) file8Url = await uploadFileToStorage(file8, `file8/${ts}_${file8.name}`);
                            const file9 = form.querySelector("input[name='file9']")?.files?.[0] || null;
                            if (file9) file9Url = await uploadFileToStorage(file9, `file9/${ts}_${file9.name}`);
                        } catch (uploadErr) {
                            return;
                        }
                        const row = {
                            "Department": form["Department"].value,
                            "Portfolio Name": form["Portfolio Name"].value,
                            "Portfolio Member Name": form["Portfolio Memeber Name"]?.value || form["Portfolio Member Name"]?.value || '',
                            "Month": form["Month"].value,
                            "Week no": form["Week no"].value ? parseInt(form["Week no"].value) : null,
                            "Week Starting Date": form["Week Starting Date"].value || null,
                            "Week Ending Date": form["Week Ending Date"].value || null,
                            "Status_1": form["Status_1"].value,
                            "Description_1": form["Description_1"].value,
                            "Upload The Scanned File_1": file1Url,
                            "Status_2": form["Status_2"].value,
                            "Description_2": form["Description_2"].value,
                            "Upload The Scanned File_2": file2Url,
                            "Status_3": form["Status_3"].value,
                            "Description_3": form["Description_3"].value,
                            "Upload The Scanned File_3": file3Url,
                            "Status_4": form["Status_4"].value,
                            "Description_4": form["Description_4"].value,
                            "Upload The Scanned File_4": file4Url,
                            "Status_5": form["Status_5"].value,
                            "Description_5": form["Description_5"].value,
                            "Upload The Scanned File_5": file5Url,
                            "Status_6": form["Status_6"].value,
                            "Description_6": form["Description_6"].value,
                            "Upload The Scanned File_6": file6Url,
                            "Status_7": form["Status_7"].value,
                            "Description_7": form["Description_7"].value,
                            "Upload The Scanned File_7": file7Url,
                            "Status_8": form["Status_8"].value,
                            "Description_8": form["Description_8"].value,
                            "Upload The Scanned File_8": file8Url,
                            "Status_9": form["Status_9"]?.value || '',
                            "Description_9": form["Description_9"]?.value || '',
                            "Upload The Scanned File_9": file9Url
                        };
                        const { data, error } = await supabaseClient
                            .from('form8-Once in Semester')
                            .insert([row]);
                        if (error) {
                            submitBtn.classList.remove('submit-btn-loading');
                            submitBtn.innerHTML = originalText;
                            window.location.href = 'notification.html?status=error&msg=' + encodeURIComponent(error.message);
                        } else {
                            window.location.href = 'notification.html?status=success';
                            form.reset();
                        }
                    });
                }
                } else {
                    console.error('Supabase script not loaded!');
                }
            });
            </script>
                            
        </script>
    <!-- Navigation Buttons -->
    <div class="fixed bottom-6 right-6 flex gap-3 z-50">
        <button onclick="history.back()" aria-label="Back" class="bg-pmcPurple hover:bg-pmcPurpleDark text-white rounded-full shadow-lg p-3 flex items-center justify-center text-2xl transition">
            &#8592;
        </button>
        <button onclick="history.forward()" aria-label="Forward" class="bg-pmcPurple hover:bg-pmcPurpleDark text-white rounded-full shadow-lg p-3 flex items-center justify-center text-2xl transition">
            &#8594;
        </button>
    </div>
    <script src="/javascript/faculty-form.js"></script>

    <script>
    // Upload indication logic for all file upload fields
    document.addEventListener('DOMContentLoaded', function() {
        function setupUploadIndication(formId, fileInputNames) {
            var form = document.getElementById(formId);
            if (!form) return;
            fileInputNames.forEach(function(name) {
                var input = form.querySelector(`input[name='${name}']`);
                if (!input) return;
                // Find the label to append indicator (robust: look for parent label or direct parent)
                var label = input.closest('label');
                if (!label) {
                    // Try to find the label in the parent div
                    var parentDiv = input.parentNode;
                    var labels = parentDiv.querySelectorAll('label');
                    label = Array.from(labels).find(l => l.contains(input));
                }
                if (!label) return;
                // Create indicator container
                var indicator = document.createElement('div');
                indicator.className = 'upload-indicator';
                indicator.style.display = 'none';
                var uploadedSpan = document.createElement('span');
                uploadedSpan.textContent = 'Uploaded';
                var cancelBtn = document.createElement('button');
                cancelBtn.type = 'button';
                cancelBtn.textContent = 'Cancel';
                indicator.appendChild(uploadedSpan);
                indicator.appendChild(cancelBtn);
                label.parentNode.appendChild(indicator);
                // Show indicator and hide label on file select
                input.addEventListener('change', function() {
                    if (input.files && input.files.length > 0) {
                        indicator.style.display = 'flex';
                        label.style.display = 'none';
                    } else {
                        indicator.style.display = 'none';
                        label.style.display = '';
                    }
                });
                // Cancel button logic
                cancelBtn.addEventListener('click', function() {
                    input.value = '';
                    indicator.style.display = 'none';
                    label.style.display = '';
                });
            });
        }
        // Weekly form (unchanged, still shows label)
        setupUploadIndication('form8WeeklyForm', ['file1', 'file2']);
        // Once in 3 Months form (hide label on upload)
        setupUploadIndication('once3MonthsForm8', ['file1', 'file2']);
        // Semester form (hide label on upload)
        setupUploadIndication('semesterForm4', ['file1', 'file2', 'file3', 'file4', 'file5', 'file6', 'file7', 'file8', 'file9']);
    });
    </script>

</body>
</html>
