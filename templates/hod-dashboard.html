<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HOD Dashboard - Faculty Core Scope Compliance</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
</head>
<body class="bg-pmcBg min-h-screen">
  <header class="bg-purple-700 text-white w-full">
    <div class="max-w-7xl mx-auto flex items-center justify-between px-4 py-3">
      <div class="flex items-center">
        <img src="https://tse1.mm.bing.net/th/id/OIP.paY-ha-IpNQJrH2Lz_JZEgHaDG?w=2560&h=1070&rs=1&pid=ImgDetMain&o=7&rm=3" alt="PMC Logo" class="h-12 rounded shadow bg-white p-1" />
        <span class="ml-4 text-xl font-bold">HOD Dashboard</span>
      </div>
    </div>
  </header>
  <main class="max-w-7xl mx-auto px-4 py-8">
    <h2 class="text-2xl font-bold text-purple-700 mb-6">Faculty Mandatory Scope - Yearly</h2>
    <div class="mb-6 flex flex-wrap gap-4 items-center">
      <label for="designationFilter" class="font-medium text-purple-700 mr-2">Filter by Designation:</label>
      <select id="designationFilter" class="p-2 border rounded">
        <option value="All">All</option>
        <option value="AP">Assistant Professor (AP)</option>
        <option value="ASP">Associate Professor (ASP)</option>
        <option value="Prof">Professor (Prof)</option>
      </select>
      <label for="yearlyMonthFilter" class="font-medium text-purple-700 mr-2">Month:</label>
      <select id="yearlyMonthFilter" class="p-2 border rounded">
        <option value="January">January</option>
        <option value="February">February</option>
        <option value="March">March</option>
        <option value="April">April</option>
        <option value="May">May</option>
        <option value="June">June</option>
        <option value="July">July</option>
        <option value="August">August</option>
        <option value="September">September</option>
        <option value="October">October</option>
        <option value="November">November</option>
        <option value="December">December</option>
      </select>
    </div>
    <div id="dashboardTableContainer" class="overflow-x-auto"></div>
    <!-- Modal for viewing Yearly form details from dashboard table -->
    <div id="viewFormModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
      <div class="bg-white rounded-lg shadow-lg max-w-2xl w-full p-6 relative max-h-[90vh] overflow-y-auto">
        <button onclick="closeViewFormModal()" class="absolute top-2 right-2 text-gray-500 hover:text-red-600 text-2xl font-bold">&times;</button>
        <h3 id="viewFormModalTitle" class="text-xl font-bold mb-4 text-purple-700">Faculty Form Details</h3>
        <div id="viewFormModalContent"></div>
      </div>
    </div>

    <!-- NEW: Faculty Core Scope - Monthly Table -->
    <h2 class="text-2xl font-bold text-green-700 mt-12 mb-6">Faculty Core Scope - Monthly</h2>
    <div class="mb-6 flex flex-wrap gap-4 items-center">
      <label for="coreScopeDesignationFilter" class="font-medium text-green-700 mr-2">Filter by Designation:</label>
      <select id="coreScopeDesignationFilter" class="p-2 border rounded">
        <option value="All">All</option>
        <option value="AP">AP</option>
        <option value="ASP">ASP</option>
        <option value="Prof">Prof</option>
      </select>
      <label for="coreScopeMonthFilter" class="font-medium text-green-700 mr-2">Month:</label>
      <select id="coreScopeMonthFilter" class="p-2 border rounded">
        <option value="January">January</option>
        <option value="February">February</option>
        <option value="March">March</option>
        <option value="April">April</option>
        <option value="May">May</option>
        <option value="June">June</option>
        <option value="July">July</option>
        <option value="August">August</option>
        <option value="September">September</option>
        <option value="October">October</option>
        <option value="November">November</option>
        <option value="December">December</option>
      </select>
    </div>
    <div id="coreScopeTableContainer" class="overflow-x-auto"></div>
  <!-- Department Portfolios Table -->
  <h2 class="text-2xl font-bold text-orange-700 mt-12 mb-6">Department Portfolios</h2>
  <div id="departmentPortfoliosStickyHeader" class="flex flex-wrap gap-4 items-center mb-4 bg-white z-20" style="position:sticky; top:0; box-shadow:0 2px 8px rgba(0,0,0,0.04);">
    <label for="portfolioMonthFilter" class="font-medium text-orange-700 mr-2">Month:</label>
    <select id="portfolioMonthFilter" class="p-2 border rounded">
      <option value="January">January</option>
      <option value="February">February</option>
      <option value="March">March</option>
      <option value="April">April</option>
      <option value="May">May</option>
      <option value="June">June</option>
      <option value="July">July</option>
      <option value="August">August</option>
      <option value="September">September</option>
      <option value="October">October</option>
      <option value="November">November</option>
      <option value="December">December</option>
    </select>
    <label for="portfolioStatusFilter" class="font-medium text-orange-700 mr-2">Show:</label>
    <select id="portfolioStatusFilter" class="p-2 border rounded">
      <option value="All">All</option>
      <option value="Completed">Completed</option>
      <option value="Pending">Pending</option>
    </select>
  </div>
  <div id="departmentPortfoliosContainer" class="overflow-x-auto mt-2"></div>
    <!-- Modal for viewing original form -->
    <div id="viewFormModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
      <div class="bg-white rounded-lg shadow-lg max-w-2xl w-full p-6 relative max-h-[90vh] overflow-y-auto">
        <button onclick="closeViewFormModal()" class="absolute top-2 right-2 text-gray-500 hover:text-red-600 text-2xl font-bold">&times;</button>
        <h3 id="viewFormModalTitle" class="text-xl font-bold mb-4 text-purple-700">Faculty Form Details</h3>
        <div id="viewFormModalContent"></div>
      </div>
    </div>
  </main>
  <script src="/static/javascript/form-modal-mapper.js"></script>
  <script>
    // Initialize Supabase client first
    const supabaseClient = window.supabase.createClient(
      "https://cbhodgwaazmjszkujrti.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiaG9kZ3dhYXptanN6a3VqcnRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2NzY4NzEsImV4cCI6MjA3MTI1Mjg3MX0.sBRdfiWJJmZtLWsHCcNyxm1VcwkGwZWsIeeMlS49XTU"
    );
    
    // Get department from query param or localStorage
    function getQueryParam(name) {
      const url = new URL(window.location.href);
      return url.searchParams.get(name);
    }
    const departmentParam = getQueryParam('department');
    const department = departmentParam || localStorage.getItem('department') || '';
    
    function closeViewStatusFormModal() {
      document.getElementById('viewStatusFormModal').classList.add('hidden');
      document.getElementById('viewStatusFormModalContent').innerHTML = '';
      document.getElementById('viewStatusFormModalTitle').textContent = 'Faculty Portfolio Form Details';
    }

    async function viewStatusFacultyForm(designation, facultyName, department) {
      document.getElementById('viewStatusFormModal').classList.remove('hidden');
      document.getElementById('viewStatusFormModalContent').innerHTML = '<div class="text-center text-gray-500">Loading form data...</div>';
      let tableName = '';
      let nameField = '';
      let deptField = '';
      if (designation === 'AP') { tableName = 'AP'; nameField = 'Portfolio Member Name'; deptField = 'Department'; }
      else if (designation === 'ASP') { tableName = 'ASP'; nameField = 'Portfolio Member Name'; deptField = 'Department:'; }
      else if (designation === 'Prof') { tableName = 'Prof'; nameField = 'Portfolio Member Name'; deptField = 'Department:'; }
      else {
        document.getElementById('viewStatusFormModalContent').innerHTML = '<div class="text-red-500">Unknown designation.</div>';
        return;
      }
      const { data, error } = await supabaseClient
        .from(tableName)
        .select('*')
        .eq(deptField, department)
        .eq(nameField, facultyName)
        .order('input_id', { ascending: false });
      if (error || !data || data.length === 0) {
        document.getElementById('viewStatusFormModalContent').innerHTML = '<div class="text-red-500">Form data not found.</div>';
        return;
      }
      const row = data[0];
      let html = '';
      html += `<div class="mb-4">
        <div class="font-semibold text-blue-700">Department:</div>
        <div class="mb-2">${row[deptField] || row['Department:'] || row['Department'] || ''}</div>
        <div class="font-semibold text-blue-700">Portfolio Name:</div>
        <div class="mb-2">${row['Portfolio Name'] || row['Portfolio Name:'] || ''}</div>
        <div class="font-semibold text-blue-700">Portfolio Member Name:</div>
        <div class="mb-2">${row['Portfolio Member Name'] || ''}</div>
      </div>`;
      let sections = [];
      if (designation === 'AP') {
        sections = [
          'Teaching and Curriculum Delivery: Design and deliver lectures, tutorials, and lab sessions as per the academic calendar and subjects assigned.',
          'Teaching and Curriculum Delivery: Develop course materials, lesson plans, and assessments aligned with OBE for the subjects assigned.',
          'Teaching and Curriculum Delivery: Incorporate innovative teaching methods, including ICT tools and experiential learning.',
          'Teaching and Curriculum Delivery: Prepare Product model and instructional Chart for the assigned subject.',
          'Student Mentorship and Support: Act as academic mentors and guide 30 students on coursework, projects, and career planning.',
          'Student Mentorship and Support: Monitor student attendance, performance, and well-being.',
          'Student Mentorship and Support: Provide remedial support and encourage participation in co-curricular and extra-curricular activities.',
          'Student Mentorship and Support: Maintain the Mentor book for assigned mentee.',
          'Student Mentorship and Support: Consolidate innovative course material, Lab manuals',
          'Research and Development: Present at conferences.',
          'Research and Development: Guide student research and final-year projects',
          'Institutional Development: Participate in curriculum development and revision through Boards of Studies.',
          'Institutional Development: Contribute to accreditation processes (NBA, NAAC) and quality assurance initiatives.',
          'Institutional Development: Serve on academic and administrative committees.',
          'Professional Development: Attend FDP/ workshops/ seminar.',
          'Professional Development: Pursue higher qualifications, NPTEL/MOOC and certifications, and memberships in professional bodies.',
          'Community and Industry Engagement: Facilitate industry-institute interaction through guest lectures, Internships.',
          'Community and Industry Engagement: Engage in extension activities, and social outreach Programs.',
          'Administrative Duties: Maintain academic records, course files, Log Book and student evaluations.',
          'Administrative Duties: Assist in examination duties, including question paper setting, invigilation, and evaluation.',
          'Administrative Duties: Submit the FPBA (Faculty performance Based Appraisal) along with the support documents on time.'
        ];
      } else if (designation === 'ASP' || designation === 'Prof') {
        sections = [
          'Teaching and Curriculum Delivery: Design and deliver lectures, tutorials, and lab sessions as per the academic calendar and subjects assigned.',
          'Teaching and Curriculum Delivery: Develop course materials, lesson plans, and assessments aligned with OBE for the subjects assigned.',
          'Teaching and Curriculum Delivery: Incorporate innovative teaching methods, including ICT tools and experiential learning.',
          'Teaching and Curriculum Delivery: Prepare Product model and instructional Chart for the assigned subject.',
          'Student Mentorship and Support: Act as academic mentors and guide 30 students on coursework, projects, and career planning.',
          'Student Mentorship and Support: Monitor student attendance, performance, and well-being.',
          'Student Mentorship and Support: Provide remedial support and encourage participation in co-curricular and extra-curricular activities.',
          'Student Mentorship and Support: Maintain the Mentor book for assigned mentee.',
          'Student Mentorship and Support: Consolidate innovative course material, Lab manuals',
          'Research and Development: Present at conferences.',
          'Research and Development: Guide student research and final-year projects',
          'Institutional Development: Participate in curriculum development and revision through Boards of Studies.',
          'Institutional Development: Contribute to accreditation processes (NBA, NAAC) and quality assurance initiatives.',
          'Institutional Development: Serve on academic and administrative committees.',
          'Professional Development: Attend FDP/ workshops/ seminar.',
          'Professional Development: Pursue higher qualifications, NPTEL/MOOC and certifications, and memberships in professional bodies.',
          'Community and Industry Engagement: Facilitate industry-institute interaction through guest lectures, Internships.',
          'Community and Industry Engagement: Engage in extension activities, and social outreach Programs.',
          'Administrative Duties: Maintain academic records, course files, Log Book and student evaluations.',
          'Administrative Duties: Assist in examination duties, including question paper setting, invigilation, and evaluation.',
          'Administrative Duties: Submit the FPBA (Faculty performance Based Appraisal) along with the support documents on time.'
        ];
      }
      html += `<div class="space-y-4">`;
      for (let i = 1; i <= sections.length; i++) {
        const statusVal = row[`Status_${i}`] || '-';
        const descVal = row[`Description_${i}`] || '-';
        let uploadVal = row[`Upload The Scanned File_${i}`] || row[`Upload the scanned file_${i}`] || '-';
        let uploadHtml = '-';
        if (uploadVal && uploadVal !== '-' && typeof uploadVal === 'string') {
          const isUrl = uploadVal.startsWith('http://') || uploadVal.startsWith('https://');
          const isFile = uploadVal.match(/\.(pdf|docx?|xlsx?|jpg|jpeg|png)$/i);
          if (isUrl || isFile) {
            uploadHtml = `<a href="${uploadVal}" target="_blank" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded shadow text-sm font-semibold inline-block">View</a>`;
          } else {
            uploadHtml = uploadVal;
          }
        }
        html += `<div class="border-b pb-2 mb-2">
          <div class="font-semibold text-orange-500 mb-1">${i}. ${sections[i-1]}</div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-2">
            <div><span class="font-medium text-blue-700">Status:</span> ${statusVal}</div>
            <div><span class="font-medium text-blue-700">Description:</span> ${descVal}</div>
            <div><span class="font-medium text-blue-700">Upload:</span> ${uploadHtml}</div>
          </div>
        </div>`;
      }
      html += `</div>`;
      document.getElementById('viewStatusFormModalContent').innerHTML = html;
      document.getElementById('viewStatusFormModalTitle').textContent = `${designation} Portfolio Form Details`;
    }
    // --- NEW: Faculty Core Scope - Monthly Table from Core_scope table ---
    let selectedCoreScopeDesignation = 'All';
    let selectedCoreScopeMonth = 'January';
    
    document.getElementById('coreScopeDesignationFilter').addEventListener('change', () => {
      selectedCoreScopeDesignation = document.getElementById('coreScopeDesignationFilter').value;
      loadCoreScopeTable();
    });
    
    document.getElementById('coreScopeMonthFilter').addEventListener('change', () => {
      selectedCoreScopeMonth = document.getElementById('coreScopeMonthFilter').value;
      loadCoreScopeTable();
    });
    
    async function loadCoreScopeTable() {
      if (!department) {
        document.getElementById('coreScopeTableContainer').innerHTML = '<div class="text-gray-500">No department selected.</div>';
        return;
      }
      
      // Fetch faculty from Faculty table for current department
      let facultyQuery = supabaseClient.from('Faculty').select('*').eq('department', department);
      const { data: facultyList, error: facErr } = await facultyQuery;
      if (facErr || !facultyList || facultyList.length === 0) {
        document.getElementById('coreScopeTableContainer').innerHTML = '<div class="text-red-500">Failed to load faculty data.</div>';
        return;
      }
      
      // Fetch Core_scope data - filter by department and month
      let coreScopeQuery = supabaseClient.from('Core_scope').select('*').eq('Month', selectedCoreScopeMonth).eq('Department', department);
      const { data: coreScopeData, error: csErr } = await coreScopeQuery;
      
      // Core Scope field labels (15 fields) - Full descriptions from faculty-core-scope.html
      const coreScopeLabels = [
        'Teaching & Curriculum Delivery: Design and deliver lectures, tutorials, and lab sessions as per the academic calendar and subjects assigned.',
        'Teaching & Curriculum Delivery: Develop course materials, lesson plans, and assessments aligned with OBE for the subjects assigned.',
        'Teaching & Curriculum Delivery: Incorporate innovative teaching methods, including ICT tools and experiential learning.',
        'Teaching & Curriculum Delivery: Prepare Product model and instructional Chart for the assigned subject.',
        'Student Mentorship & Support: Act as academic mentors and guide 30 students on coursework, projects, and career planning.',
        'Student Mentorship & Support: Monitor student attendance, performance, and well-being.',
        'Student Mentorship & Support: Provide remedial support and encourage participation in co-curricular and extra-curricular activities.',
        'Student Mentorship & Support: Maintain the Mentor book for assigned mentee.',
        'Student Mentorship & Support: Consolidate innovative course material, Lab manuals',
        'Research and Development: Present at conferences.',
        'Research and Development: Guide student research and final-year projects',
        'Institutional Development: Participate in curriculum development and revision through Boards of Studies.',
        'Institutional Development: Contribute to accreditation processes (NBA, NAAC) and quality assurance initiatives.',
        'Institutional Development: Serve on academic and administrative committees.',
        'Administrative Duties: Maintain academic records, course files, Log Book and student evaluations.'
      ];
      
      // Shorter labels for table headers
      const coreScopeShortLabels = [
        'Design & deliver lectures',
        'Develop course materials',
        'Innovative teaching methods',
        'Product model & Chart',
        'Academic mentors (30 students)',
        'Monitor attendance',
        'Remedial support',
        'Maintain Mentor book',
        'Innovative course material',
        'Present at conferences',
        'Guide research projects',
        'Curriculum development',
        'Accreditation processes',
        'Academic committees',
        'Maintain records'
      ];
      
      // Filter faculty by designation if needed
      let filteredFacultyList = facultyList;
      if (selectedCoreScopeDesignation !== 'All') {
        filteredFacultyList = facultyList.filter(fac => {
          const desig = (fac.Designation || '').toUpperCase();
          if (selectedCoreScopeDesignation === 'AP') return desig === 'AP' || desig === 'ASSISTANT PROFESSOR';
          if (selectedCoreScopeDesignation === 'ASP') return desig === 'ASP' || desig === 'ASSOCIATE PROFESSOR';
          if (selectedCoreScopeDesignation === 'Prof') return desig === 'PROF' || desig === 'PROFESSOR';
          return false;
        });
      }
      
      let html = '';
      
      if (filteredFacultyList.length === 0) {
        document.getElementById('coreScopeTableContainer').innerHTML = '<div class="text-gray-500">No faculty data found.</div>';
        return;
      }
      
      // Single table header with Designation column - wrapped in scrolling container
      html += `<div class="overflow-auto mb-6 border rounded-lg shadow-sm" style="max-height: 600px;"><table class="min-w-full text-xs bg-white" style="table-layout: auto;"><thead class="bg-green-700 text-white sticky top-0 z-20"><tr>`;
      html += `<th class="px-3 py-2 sticky left-0 bg-green-700 z-30" style="min-width: 150px;">Department</th>`;
      html += `<th class="px-3 py-2 bg-green-700" style="min-width: 120px;">Designation</th>`;
      html += `<th class="px-3 py-2" style="min-width: 180px;">Faculty Name</th>`;
      html += `<th class="px-3 py-2" style="min-width: 100px;">Percentage</th>`;
      
      // Add columns for all 15 status fields with full descriptions as tooltips
      for (let i = 0; i < 15; i++) {
        html += `<th class="px-2 py-2" style="min-width: 120px;" title="${coreScopeLabels[i]}">${coreScopeShortLabels[i]}</th>`;
      }
      
      html += `</tr></thead><tbody>`;
      
      // Process each faculty
      for (const fac of filteredFacultyList) {
        const facultyName = fac.Name || fac['Portfolio Member Name'] || fac.email || 'Unknown';
        const dept = fac.department || department;
        const designation = fac.Designation || 'N/A';
        
        // Normalize designation for display
        let desigDisplay = designation;
        const desigUpper = designation.toUpperCase();
        if (desigUpper === 'ASSISTANT PROFESSOR') desigDisplay = 'AP';
        else if (desigUpper === 'ASSOCIATE PROFESSOR') desigDisplay = 'ASP';
        else if (desigUpper === 'PROFESSOR') desigDisplay = 'Prof';
        
        // Find matching Core_scope data for this faculty
        let facNamesToTry = [];
        if (fac['Portfolio Member Name']) facNamesToTry.push(fac['Portfolio Member Name']);
        if (fac.Name) facNamesToTry.push(fac.Name);
        if (fac.email) facNamesToTry.push(fac.email);
        facNamesToTry = Array.from(new Set(facNamesToTry.map(n => (n || '').toString().trim().toLowerCase()).filter(Boolean)));
        
        let matchingRows = [];
        if (coreScopeData && coreScopeData.length > 0) {
          matchingRows = coreScopeData.filter(row => {
            const rowName = (row['Portfolio Member Name'] || '').toString().trim().toLowerCase();
            return facNamesToTry.includes(rowName);
          });
        }
        
        // Get the latest row (by input_id)
        let row = null;
        if (matchingRows.length > 0) {
          matchingRows.sort((a, b) => (b.input_id || 0) - (a.input_id || 0));
          row = matchingRows[0];
        }
        
        // Calculate percentage
        let completedCount = 0;
        let applicableCount = 0;
        
        if (row) {
          for (let i = 1; i <= 15; i++) {
            const statusVal = (row[`Status_${i}`] || '').toString().trim().toLowerCase();
            if (statusVal === 'not applicable' || statusVal === 'na') continue;
            applicableCount += 1;
            if (statusVal === 'completed') completedCount += 1;
          }
        }
        
        const percentage = applicableCount > 0 ? Math.round((completedCount / applicableCount) * 100) : 0;
        const percentageDisplay = row ? `${percentage}%` : '0% (Not Submitted)';
        const percentageClass = row ? (percentage >= 70 ? 'text-green-600' : percentage >= 50 ? 'text-yellow-600' : 'text-red-600') : 'text-red-600';
        
        html += `<tr class="hover:bg-gray-50">`;
        html += `<td class="px-3 py-2 border sticky left-0 bg-white z-10 font-medium">${dept}</td>`;
        html += `<td class="px-3 py-2 border font-medium">${desigDisplay}</td>`;
        html += `<td class="px-3 py-2 border font-medium text-green-700">${facultyName}</td>`;
        html += `<td class="px-3 py-2 border ${percentageClass} font-semibold">${percentageDisplay}</td>`;
        
        // Add status cells for all 15 fields
        for (let i = 1; i <= 15; i++) {
          const statusVal = row ? (row[`Status_${i}`] || '-') : '-';
          let display = '-';
          let statusClass = '';
          
          if (row && statusVal && typeof statusVal === 'string') {
            const val = statusVal.trim().toLowerCase();
            if (val === 'completed') {
              display = 'Completed';
              statusClass = 'text-green-600 font-semibold';
            } else if (val === 'in progress' || val === 'inprogress') {
              display = 'In Progress';
              statusClass = 'text-yellow-600 font-semibold';
            } else if (val === 'yet to be completed' || val === 'not started') {
              display = 'Yet to be Completed';
              statusClass = 'text-red-600 font-semibold';
            } else if (val === 'not applicable' || val === 'na') {
              display = 'N/A';
              statusClass = 'text-gray-400';
            } else if (val === '-' || val === '' || val === null) {
              display = '-';
              statusClass = 'text-gray-500';
            } else {
              display = statusVal;
              statusClass = 'text-blue-600 font-semibold';
            }
          } else {
            display = '-';
            statusClass = 'text-gray-500';
          }
          
          html += `<td class="px-2 py-2 border ${statusClass}">${display}</td>`;
        }
        
        html += `</tr>`;
      }
      
      html += `</tbody></table></div>`;
      
      document.getElementById('coreScopeTableContainer').innerHTML = html || '<div class="text-gray-500">No faculty data found.</div>';
    }
    // --- END NEW: Core Scope Table ---
  </script>
  <script>
    // Fetch and render department portfolios table (HOD) - IQAC style
    async function loadDepartmentPortfolios() {
      const currentDept = department;
      if (!currentDept) {
        document.getElementById('departmentPortfoliosContainer').innerHTML = '<div class="text-gray-500">No department selected.</div>';
        return;
      }
      
      // Fetch faculty for current department only
      const { data, error } = await supabaseClient
        .from('Faculty')
        .select('*')
        .eq('department', currentDept);
      if (error || !data || data.length === 0) {
        document.getElementById('departmentPortfoliosContainer').innerHTML = '<div class="text-red-500">Failed to load faculty data for this department.</div>';
        return;
      }
      
      // Get month and status filters
      const monthFilter = document.getElementById('portfolioMonthFilter');
      const selectedMonth = monthFilter ? monthFilter.value : 'January';
      const statusFilter = document.getElementById('portfolioStatusFilter');
      const selectedStatus = statusFilter ? statusFilter.value : 'All';
      
      // Portfolio headers (only monthly tables)
      const portfolioHeaders = [
        { label: "1. Training & Placement", table: 'form1-monthly' },
        { label: "2. Class Advisor", table: 'form2-monthly' },
        { label: "3. Info & Contribution", table: 'form3-monthly' },
        { label: "4. Outcome & Exam Cell", table: 'form4-monthly' },
        { label: "5. Continuous Improvement", table: 'form5-monthly' },
        { label: "6. T&L Process (IQAC)", table: 'form6_monthly' },
        { label: "7. Student Support", table: 'form7-monthly' },
        { label: "8. Facilities & Lab", table: 'form8-monthly' }
      ];
      
      // Build table: Department | Designation | Faculty Name | Portfolio Name | Percentage
      let html = '';
      html += '<h3 class="text-xl font-bold text-orange-500 mb-2">Department Portfolios</h3>';
      html += '<div style="overflow-x:auto; max-height:600px; overflow-y:auto; border:1px solid #9ca3af; border-radius:8px;">';
      html += '<table class="w-full text-sm bg-white" style="border-collapse:collapse;">';
      html += '<thead class="bg-orange-100 text-orange-700" style="position:sticky; top:0; z-index:10;">';
      html += '<tr>';
      html += '<th class="px-3 py-2 border border-gray-400 text-left" style="background:#FEF3C7; min-width:120px;">Department</th>';
      html += '<th class="px-3 py-2 border border-gray-400 text-left" style="background:#FEF3C7; min-width:100px;">Designation</th>';
      html += '<th class="px-3 py-2 border border-gray-400 text-left" style="background:#FEF3C7; min-width:180px;">Faculty Name</th>';
      html += '<th class="px-3 py-2 border border-gray-400 text-left" style="background:#FEF3C7; min-width:200px;">Portfolio Name</th>';
      html += '<th class="px-3 py-2 border border-gray-400 text-left" style="background:#FEF3C7; min-width:150px;">Percentage</th>';
      html += '</tr></thead>';
      html += '<tbody>';
      
      // Build rows: one row per faculty per portfolio
      const tableRows = [];
      for (const fac of data) {
        const facultyName = fac.Name || fac['Portfolio Member Name'] || fac.email || 'Unknown';
        const designation = fac.Designation || fac.designation || 'N/A';
        
        // Check which portfolios this faculty is assigned to
        for (const h of portfolioHeaders) {
          const formKey = h.label.match(/\d+/) ? `form${h.label.match(/\d+/)[0]}` : '';
          const isAssigned = fac[formKey] && fac[formKey].trim().toLowerCase() === 'yes';
          
          if (isAssigned) {
            const rowId = `${currentDept.replace(/[^a-zA-Z0-9]/g, '')}-${formKey}-${facultyName.replace(/[^a-zA-Z0-9]/g, '')}`;
            tableRows.push({
              dept: currentDept,
              designation,
              facultyName,
              portfolioName: h.label,
              tableName: h.table,
              formKey,
              rowId
            });
          }
        }
      }
      
      // Sort rows by portfolio number (1-8)
      tableRows.sort((a, b) => {
        const aNum = parseInt(a.portfolioName.match(/^\d+/)?.[0] || '99');
        const bNum = parseInt(b.portfolioName.match(/^\d+/)?.[0] || '99');
        return aNum - bNum;
      });
      
      // Render rows
      for (const row of tableRows) {
        html += `<tr class="hover:bg-gray-50">`;
        html += `<td class="px-3 py-2 border border-gray-400" style="min-width:120px;">${row.dept}</td>`;
        html += `<td class="px-3 py-2 border border-gray-400" style="min-width:100px;">${row.designation}</td>`;
        html += `<td class="px-3 py-2 border border-gray-400" style="min-width:180px;">${row.facultyName}</td>`;
        html += `<td class="px-3 py-2 border border-gray-400" style="min-width:200px;">${row.portfolioName}</td>`;
        html += `<td class="px-3 py-2 border border-gray-400" style="min-width:150px;" id="percent-${row.rowId}">Loading...</td>`;
        html += `</tr>`;
      }
      
      html += '</tbody></table></div>';
      document.getElementById('departmentPortfoliosContainer').innerHTML = html;
      
      // Async percentage calculation for each faculty-portfolio combination
      for (const row of tableRows) {
        (async () => {
          let filled = false;
          let percentage = 0;
          let query = supabaseClient.from(row.tableName).select('*').eq('Department', row.dept);
          const { data: formData, error } = await query;
          let bestRow = null;
          if (!error && formData && formData.length > 0) {
            // Robust faculty name matching with month filtering
            const filteredRows = formData.filter(dataRow => {
              const rowName = dataRow['Portfolio Member Name:'] || dataRow['Portfolio Member Name'] || dataRow['Portfolio Memeber Name'] || dataRow['faculty_name'] || dataRow['Faculty Name'] || dataRow['Name'] || '';
              // Check month field (Month, month, or Month:)
              const rowMonth = dataRow['Month'] || dataRow['month'] || dataRow['Month:'] || '';
              const nameMatches = rowName.toString().trim().toLowerCase() === row.facultyName.toString().trim().toLowerCase();
              const monthMatches = rowMonth.toString().trim().toLowerCase() === selectedMonth.toLowerCase();
              return nameMatches && monthMatches;
            });
            if (filteredRows.length > 0) {
              filled = true;
              // Use the latest row (by id or timestamp)
              bestRow = filteredRows.sort((a, b) => (b.id || 0) - (a.id || 0))[0];
            }
          }
          // Calculate percentage if bestRow exists, using all keys starting with 'Status'
          if (bestRow) {
            let completedCount = 0;
            let applicableCount = 0;
            // Use all keys starting with 'Status' (case-sensitive)
            const statusKeys = Object.keys(bestRow).filter(k => k.startsWith('Status'));
            for (const key of statusKeys) {
              const val = (bestRow[key] || '').toString().trim().toLowerCase();
              if (val === 'not applicable' || val === 'na') continue;
              // Treat null, empty, or '-' as applicable (mark=0)
              applicableCount += 1;
              if (val === 'completed' || val === 'completed and updated') {
                completedCount += 1;
              }
            }
            if (applicableCount > 0) {
              percentage = Math.round((completedCount / applicableCount) * 100);
            } else {
              percentage = 0;
            }
          } else {
            percentage = 0;
          }
          
          // Update the percentage cell
          const percentCell = document.getElementById(`percent-${row.rowId}`);
          if (percentCell) {
            // Apply status filter
            if (selectedStatus === 'Completed' && !filled) {
              percentCell.parentElement.style.display = 'none';
              return;
            }
            if (selectedStatus === 'Pending' && filled) {
              percentCell.parentElement.style.display = 'none';
              return;
            }
            
            // Display percentage with color coding
            if (filled) {
              percentCell.innerHTML = `<span class="font-semibold ${percentage >= 70 ? 'text-green-600' : percentage >= 50 ? 'text-yellow-600' : 'text-red-600'}">${percentage}%</span>`;
            } else {
              percentCell.innerHTML = `<span class="text-red-600 font-semibold">0% (Not Submitted)</span>`;
            }
          }
        })();
      }
      
      // Add filter event listeners
      const monthFilterEl = document.getElementById('portfolioMonthFilter');
      const statusFilterEl = document.getElementById('portfolioStatusFilter');
      if (monthFilterEl) monthFilterEl.onchange = () => loadDepartmentPortfolios();
      if (statusFilterEl) statusFilterEl.onchange = () => loadDepartmentPortfolios();
    }
    
    // Fetch all faculty for department
    async function loadDashboardTable() {
      if (!department) {
        document.getElementById('dashboardTableContainer').innerHTML = '<div class="text-gray-500">No department selected.</div>';
        return;
      }
      const { data, error } = await supabaseClient
        .from('Faculty')
        .select('*')
        .eq('department', department);
      if (error || !data || data.length === 0) {
        document.getElementById('dashboardTableContainer').innerHTML = '<div class="text-red-500">Failed to load faculty data.</div>';
        return;
      }
      renderDashboardTable(data);
    }
    // Render table for all faculty, grouped by designation
  function renderDashboardTable(facultyList) {
      const designationFilter = document.getElementById('designationFilter').value;
      // Group by designation
      const groups = { AP: [], ASP: [], Prof: [] };
      facultyList.forEach(fac => {
        const desig = (fac.Designation || '').toUpperCase();
        if (desig === 'AP' || desig === 'ASSISTANT PROFESSOR') groups.AP.push(fac);
        else if (desig === 'ASP' || desig === 'ASSOCIATE PROFESSOR') groups.ASP.push(fac);
        else if (desig === 'PROF' || desig === 'PROFESSOR') groups.Prof.push(fac);
      });
      let html = '';
      // Map particulars for each designation
      const particularsMap = {
        AP: [
          'Present at Conferences.',
          'Guide student research and final-year projects.',
          'Attend FDPs / workshop/Seminars',
          'NPTEL/ MOOC certifications 2/Sem',
          'Facilitate industry-institute interaction through guest lectures, internships.',
          'Engage in extension activities, and social outreach programs.',
          'Membership in professional body'
        ],
        ASP: [
          'Publish in peer-reviewed journals',
          'Apply for research grants',
          'Guide student research and final-year projects.',
          'Organize FDPs / workshop/Seminars',
          'NPTEL/ MOOC certifications',
          'Facilitate industry-institute interaction through guest lectures, internships.',
          'Engage in Consultancy.',
          'Membership in professional body'
        ],
        Prof: [
          'Publish in peer-reviewed journals',
          'Apply for research grants',
          'Guide student research and final-year projects.',
          'Organize FDPs / workshop/Seminars',
          'NPTEL/ MOOC certifications',
          'Facilitate MoU',
          'Engage in Consultancy.',
          'Membership in professional body'
        ]
      };

      (async function renderDashboardAsync() {
        // Get selected month
        let monthFilter = document.getElementById('yearlyMonthFilter');
        let selectedMonth = monthFilter ? monthFilter.value : 'January';
        
        // Preload all yearly form data for department filtered by month
        const [apRes, aspRes, profRes] = await Promise.all([
          supabaseClient.from('AP(Yearly)').select('*').eq('Department', department).eq('Month', selectedMonth),
          supabaseClient.from('ASP(Yearly)').select('*').eq('Department', department).eq('Month', selectedMonth),
          supabaseClient.from('Prof(Yearly)').select('*').eq('Department', department).eq('Month', selectedMonth)
        ]);
        
        // Create lookup maps for form submissions
        const formDataMaps = {
          AP: {},
          ASP: {},
          Prof: {}
        };
        
        // Build lookup maps: key = facultyName (lowercase), value = latest row
        [
          { designation: 'AP', data: apRes.data || [] },
          { designation: 'ASP', data: aspRes.data || [] },
          { designation: 'Prof', data: profRes.data || [] }
        ].forEach(({ designation, data }) => {
          const grouped = {};
          data.forEach(row => {
            const facultyName = (row['Portfolio Member Name'] || '').toString().trim().toLowerCase();
            if (!grouped[facultyName]) grouped[facultyName] = [];
            grouped[facultyName].push(row);
          });
          
          // Get latest row for each faculty
          Object.keys(grouped).forEach(facultyName => {
            const rows = grouped[facultyName];
            rows.sort((a, b) => (b.input_id || 0) - (a.input_id || 0));
            formDataMaps[designation][facultyName] = rows[0];
          });
        });
        for (const key of ['AP', 'ASP', 'Prof']) {
          if (designationFilter !== 'All' && designationFilter !== key) continue;
          const group = groups[key];
          if (group.length === 0) continue;
          html += `<h3 class="text-xl font-semibold text-purple-700 mt-8 mb-2">${key === 'AP' ? 'Assistant Professor (AP)' : key === 'ASP' ? 'Associate Professor (ASP)' : 'Professor (Prof)'}</h3>`;
          const particulars = particularsMap[key];
          html += `<div class="overflow-auto mb-6 border rounded-lg shadow-sm" style="max-height: 600px;"><table class="min-w-full text-sm bg-white"><thead class="bg-purple-700 text-white sticky top-0 z-20"><tr><th class="px-4 py-2 sticky left-0 bg-purple-700 z-30">Department</th><th class="px-4 py-2 bg-purple-700">Designation</th><th class="px-4 py-2 bg-purple-700">Faculty Name</th><th class="px-4 py-2 bg-purple-700">Percentage</th>`;
          particulars.forEach(particular => {
            html += `<th class="px-4 py-2 bg-purple-700">${particular}</th>`;
          });
          html += `</tr></thead><tbody>`;
          for (const fac of group) {
            const facultyName = fac.Name || fac['Portfolio Member Name'] || fac.email || '';
            const nameTrimmed = facultyName.toString().trim().toLowerCase();
            const dept = fac.department || department;
            const designation = fac.Designation || key;
            
            // Normalize designation for display
            let desigDisplay = designation;
            const desigUpper = designation.toUpperCase();
            if (desigUpper === 'ASSISTANT PROFESSOR') desigDisplay = 'AP';
            else if (desigUpper === 'ASSOCIATE PROFESSOR') desigDisplay = 'ASP';
            else if (desigUpper === 'PROFESSOR') desigDisplay = 'Prof';
            else desigDisplay = key; // fallback to key if not recognized
            
            // Find matching yearly data for this faculty
            const row = formDataMaps[key][nameTrimmed] || null;
            
            // Calculate percentage based on Status fields
            let completedCount = 0;
            let totalCount = key === 'AP' ? 7 : 8; // AP has 7 items, ASP/Prof have 8
            
            if (row) {
              for (let i = 1; i <= totalCount; i++) {
                const status = (row[`Status_${i}`] || '').toString().toLowerCase();
                if (status === 'completed' || status === 'completed and updated') {
                  completedCount++;
                }
              }
            }
            
            const percentage = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
            
            html += `<tr class="hover:bg-gray-50"><td class="px-2 py-2 border font-medium sticky left-0 bg-white z-10">${dept}</td>`;
            html += `<td class="px-2 py-2 border font-medium">${desigDisplay}</td>`;
            html += `<td class="px-2 py-2 border font-medium text-purple-700 cursor-pointer underline" onclick="viewYearlyFacultyForm('${key}','${facultyName.replace(/'/g, "\\'")}', '${department.replace(/'/g, "\\'")}')">
                ${facultyName}
            </td>`;
            
            // Percentage column with color coding
            html += `<td class="px-2 py-2 border text-center font-bold ${percentage >= 70 ? 'bg-green-100 text-green-700' : percentage >= 50 ? 'bg-yellow-100 text-yellow-700' : 'bg-red-100 text-red-700'}">${percentage}%</td>`;
            
            // Display status for each particular
            for (let i = 1; i <= totalCount; i++) {
              const status = row ? (row[`Status_${i}`] || '-') : '-';
              const statusLower = status.toString().toLowerCase();
              let bgColor = 'bg-gray-100';
              let textColor = 'text-gray-600';
              
              if (statusLower === 'completed' || statusLower === 'completed and updated') {
                bgColor = 'bg-green-100';
                textColor = 'text-green-700';
              } else if (statusLower === 'in progress') {
                bgColor = 'bg-yellow-100';
                textColor = 'text-yellow-700';
              } else if (statusLower === 'not applicable' || statusLower === 'na' || statusLower === 'n/a') {
                bgColor = 'bg-gray-100';
                textColor = 'text-gray-500';
              } else if (statusLower !== '-') {
                bgColor = 'bg-red-100';
                textColor = 'text-red-700';
              }
              
              html += `<td class="px-2 py-2 ${bgColor} ${textColor} text-center font-medium">${status}</td>`;
            }
            html += `</tr>`;
          }
          html += `</tbody></table></div>`;
        }
        document.getElementById('dashboardTableContainer').innerHTML = html || '<div class="text-gray-500">No compliance data found.</div>';
      })();
    }
    
    document.getElementById('designationFilter').addEventListener('change', () => {
      loadDashboardTable();
    });
    
    document.getElementById('yearlyMonthFilter').addEventListener('change', () => {
      loadDashboardTable();
    });
    
    // Initialize tables
    loadDashboardTable();
    loadCoreScopeTable();
    loadDepartmentPortfolios();
    // Modal logic
    function closeViewFormModal() {
      document.getElementById('viewFormModal').classList.add('hidden');
      document.getElementById('viewFormModalContent').innerHTML = '';
      document.getElementById('viewFormModalTitle').textContent = 'Faculty Form Details';
    }

    // View yearly faculty form logic
    async function viewYearlyFacultyForm(designation, facultyName, dept) {
      document.getElementById('viewFormModal').classList.remove('hidden');
      document.getElementById('viewFormModalContent').innerHTML = '<div class="text-center text-gray-500">Loading form data...</div>';
      
      let tableName = '';
      let deptField = '';
      if (designation === 'AP') { 
        tableName = 'AP(Yearly)'; 
        deptField = 'Department';
      } else if (designation === 'ASP') { 
        tableName = 'ASP(Yearly)'; 
        deptField = 'Department';
      } else if (designation === 'Prof') { 
        tableName = 'Prof(Yearly)'; 
        deptField = 'Department';
      } else {
        document.getElementById('viewFormModalContent').innerHTML = '<div class="text-red-500">Unknown designation.</div>';
        return;
      }
      
      // Fetch all entries for this department from yearly table
      const { data, error } = await supabaseClient
        .from(tableName)
        .select('*')
        .eq(deptField, dept);
        
      if (error || !data || data.length === 0) {
        document.getElementById('viewFormModalContent').innerHTML = '<div class="text-red-500">Form data not found.</div>';
        return;
      }
      
      // Find latest entry by faculty name
      const nameTrimmed = (facultyName || '').toString().trim().toLowerCase();
      let filtered = data.filter(row => {
        let rowName = (row['Portfolio Member Name'] || '').toString().trim().toLowerCase();
        return rowName === nameTrimmed;
      });
      
      if (filtered.length === 0) {
        document.getElementById('viewFormModalContent').innerHTML = '<div class="text-red-500">No form data found for this faculty name.</div>';
        return;
      }
      
      // Get latest by input_id
      filtered.sort((a, b) => (b.input_id || 0) - (a.input_id || 0));
      const row = filtered[0];
      // Render modal with section headers from form HTML
      let html = '';
      // Top info
      html += `<div class="mb-4">
        <div class="font-semibold text-purple-700">Department:</div>
        <div class="mb-2">${row['Department'] || row['Department:'] || ''}</div>
        <div class="font-semibold text-purple-700">Portfolio Name:</div>
        <div class="mb-2">${row['Portfolio Name'] || row['Portfolio Name:'] || ''}</div>
        <div class="font-semibold text-purple-700">Portfolio Member Name:</div>
        <div class="mb-2">${row['Portfolio Member Name'] || ''}</div>
      </div>`;
      // Section headings and fields
      let sections = [];
      if (designation === 'AP') {
        sections = [
          'Teaching and Curriculum Delivery: Design and deliver lectures, tutorials, and lab sessions as per the academic calendar and subjects assigned.',
          'Teaching and Curriculum Delivery: Develop course materials, lesson plans, and assessments aligned with OBE for the subjects assigned.',
          'Teaching and Curriculum Delivery: Incorporate innovative teaching methods, including ICT tools and experiential learning.',
          'Teaching and Curriculum Delivery: Prepare Product model and instructional Chart for the assigned subject.',
          'Student Mentorship and Support: Act as academic mentors and guide 30 students on coursework, projects, and career planning.',
          'Student Mentorship and Support: Monitor student attendance, performance, and well-being.',
          'Student Mentorship and Support: Provide remedial support and encourage participation in co-curricular and extra-curricular activities.',
          'Student Mentorship and Support: Maintain the Mentor book for assigned mentee.',
          'Student Mentorship and Support: Consolidate innovative course material, Lab manuals',
          'Research and Development: Present at conferences.',
          'Research and Development: Guide student research and final-year projects',
          'Institutional Development: Participate in curriculum development and revision through Boards of Studies.',
          'Institutional Development: Contribute to accreditation processes (NBA, NAAC) and quality assurance initiatives.',
          'Institutional Development: Serve on academic and administrative committees.',
          'Professional Development: Attend FDP/ workshops/ seminar.',
          'Professional Development: Pursue higher qualifications, NPTEL/MOOC and certifications, and memberships in professional bodies.',
          'Community and Industry Engagement: Facilitate industry-institute interaction through guest lectures, Internships.',
          'Community and Industry Engagement: Engage in extension activities, and social outreach Programs.',
          'Administrative Duties: Maintain academic records, course files, Log Book and student evaluations.',
          'Administrative Duties: Assist in examination duties, including question paper setting, invigilation, and evaluation.',
          'Administrative Duties: Submit the FPBA (Faculty performance Based Appraisal) along with the support documents on time.'
        ];
      } else if (designation === 'ASP' || designation === 'Prof') {
        // For ASP and Prof, you can add their respective section headings here
        // For brevity, using AP headings as placeholder
        sections = [
          'Teaching and Curriculum Delivery: Design and deliver lectures, tutorials, and lab sessions as per the academic calendar and subjects assigned.',
          'Teaching and Curriculum Delivery: Develop course materials, lesson plans, and assessments aligned with OBE for the subjects assigned.',
          'Teaching and Curriculum Delivery: Incorporate innovative teaching methods, including ICT tools and experiential learning.',
          'Teaching and Curriculum Delivery: Prepare Product model and instructional Chart for the assigned subject.',
          'Student Mentorship and Support: Act as academic mentors and guide 30 students on coursework, projects, and career planning.',
          'Student Mentorship and Support: Monitor student attendance, performance, and well-being.',
          'Student Mentorship and Support: Provide remedial support and encourage participation in co-curricular and extra-curricular activities.',
          'Student Mentorship and Support: Maintain the Mentor book for assigned mentee.',
          'Student Mentorship and Support: Consolidate innovative course material, Lab manuals',
          'Research and Development: Present at conferences.',
          'Research and Development: Guide student research and final-year projects',
          'Institutional Development: Participate in curriculum development and revision through Boards of Studies.',
          'Institutional Development: Contribute to accreditation processes (NBA, NAAC) and quality assurance initiatives.',
          'Institutional Development: Serve on academic and administrative committees.',
          'Professional Development: Attend FDP/ workshops/ seminar.',
          'Professional Development: Pursue higher qualifications, NPTEL/MOOC and certifications, and memberships in professional bodies.',
          'Community and Industry Engagement: Facilitate industry-institute interaction through guest lectures, Internships.',
          'Community and Industry Engagement: Engage in extension activities, and social outreach Programs.',
          'Administrative Duties: Maintain academic records, course files, Log Book and student evaluations.',
          'Administrative Duties: Assist in examination duties, including question paper setting, invigilation, and evaluation.',
          'Administrative Duties: Submit the FPBA (Faculty performance Based Appraisal) along with the support documents on time.'
        ];
      }
      // Render each section with heading
      html += `<div class="space-y-4">`;
      for (let i = 1; i <= sections.length; i++) {
        let fileUrl = row[`Upload The Scanned File_${i}`] || row[`Upload the scanned file_${i}`] || '';
        let fileHtml = '-';
        if (fileUrl && typeof fileUrl === 'string' && (fileUrl.startsWith('http://') || fileUrl.startsWith('https://'))) {
          fileHtml = `<a href="${fileUrl}" target="_blank" class="inline-block bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded shadow text-xs font-semibold">View</a>`;
        } else if (fileUrl) {
          fileHtml = fileUrl;
        }
        html += `<div class="border-b pb-2 mb-2">
          <div class="font-semibold text-orange-500 mb-1">${i}. ${sections[i-1]}</div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-2">
            <div><span class="font-medium text-purple-700">Status:</span> ${row[`Status_${i}`] || '-'}</div>
            <div><span class="font-medium text-purple-700">Description:</span> ${row[`Description_${i}`] || '-'}</div>
            <div><span class="font-medium text-purple-700">Upload:</span> ${fileHtml}</div>
          </div>
        </div>`;
      }
      html += `</div>`;
      document.getElementById('viewFormModalContent').innerHTML = html;
      document.getElementById('viewFormModalTitle').textContent = `${designation} Form Details`;
    }
  </script>
  <footer class="text-center py-4 mt-8">
    <p class="text-sm">
      &copy; All Rights Reserved <a href="https://pmctech.org" target="_blank" class="underline">PMC TECH</a><br>
      <p class="text-xs opacity-80 flex items-center justify-center gap-2">
                        Powered by 
                        <a href="https://zeonytechnologies.com" target="_blank" rel="noopener noreferrer" class="inline-block hover:opacity-100 transition-all duration-300 hover:scale-105">
                            <img src="../static/img/zeony logo.png" alt="Zeony Technologies" class="h-12 w-22 py-2 object-contain"/>
                        </a><p class="text-xs opacity-80">A Student driven Software!</p>
    </p>
  </footer>
</body>
</html>
