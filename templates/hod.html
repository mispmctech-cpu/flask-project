<!-- Navigation Buttons -->
<div class="fixed bottom-6 right-6 flex gap-3 z-50">
  <button
    onclick="history.back()"
    aria-label="Back"
    class="bg-pmcPurple hover:bg-pmcPurpleDark text-white rounded-full shadow-lg p-3 flex items-center justify-center text-2xl transition"
  >
    &#8592;
  </button>
  <button
    onclick="history.forward()"
    aria-label="Forward"
    class="bg-pmcPurple hover:bg-pmcPurpleDark text-white rounded-full shadow-lg p-3 flex items-center justify-center text-2xl transition"
  >
    &#8594;
  </button>
</div>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PMC Tech HOD</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              pmcPurple: "#6a2c91",
              pmcPurpleDark: "#501e73",
              pmcBg: "#f6f4f8",
            },
          },
        },
      };
    </script>
    <style>
      .navbar {
        overflow: hidden;
        background-color: rgba(128, 0, 128, 0.412);
        font-family: Arial;
        background-color: #6a2c91;
      }

      /* Links inside the navbar */
      .navbar a {
        float: left;
        font-size: 16px;
        color: white;
        padding: 14px 16px;
        text-decoration: none;
      }

      /* The dropdown container */
      .dropdown {
        float: left;
        overflow: hidden;
      }

      /* Dropdown button */
      .dropdown .dropbtn {
        font-size: 16px;
        border: none;
        outline: none;
        color: #fff;
        padding: 14px 32px 14px 16px;
        background-color: #6a2c91;
        font-family: inherit;
        margin: 0;
        border-radius: 8px 8px 0 0;
        box-shadow: 0 2px 8px 0 rgba(106, 44, 145, 0.08);
        position: relative;
        transition: background 0.2s, color 0.2s, box-shadow 0.2s;
        cursor: pointer;
      }
      .dropdown .dropbtn::after {
        content: "\25BC";
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 12px;
        color: #fff;
        pointer-events: none;
      }
      .dropdown .dropbtn:focus,
      .dropdown .dropbtn:hover {
        background-color: #6a2c91;
        color: #fff;
        box-shadow: 0 4px 16px 0 rgba(164, 80, 139, 0.15);
      }

      /* Add a red background color to navbar links on hover */
      /* Add a modern hover effect to navbar links and dropdown button */
      .navbar a:hover,
      .dropdown:hover .dropbtn {
        background: linear-gradient(90deg, #a4508b 0%, #6a2c91 100%);
        color: #fff;
        box-shadow: 0 4px 16px 0 rgba(164, 80, 139, 0.15);
      }

      /* Dropdown content (hidden by default) */
      .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f9f9f9;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
        z-index: 1;
      }

      /* Links inside the dropdown */
      .dropdown-content a {
        float: none;
        color: purple;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        text-align: left;
      }

      /* Add a grey background color to dropdown links on hover */
      .dropdown-content a:hover {
        background-color: #ddd;
      }

      /* Show the dropdown menu on hover */
      .dropdown:hover .dropdown-content {
        display: block;
      }
    </style>
  </head>
  <body>
  <!-- Removed redirect to hod-role.html to prevent redirect loop -->
    <header class="bg-pmcPurple text-white w-full">
      <div class="max-w-7xl mx-auto flex items-center justify-between px-4 py-3">
        <!-- Logo -->
        <div class="flex items-center">
          <img src="https://tse1.mm.bing.net/th/id/OIP.paY-ha-IpNQJrH2Lz_JZEgHaDG?w=2560&h=1070&rs=1&pid=ImgDetMain&o=7&rm=3" alt="PMC Logo" class="h-12 rounded shadow bg-white p-1" />
        </div>
        <!-- Hamburger menu button (mobile only) -->
        <button id="menuBtn" class="sm:hidden ml-2 p-2 rounded focus:outline-none focus:ring-2 focus:ring-white" aria-label="Open Menu">
          <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </button>
        <!-- Nav links -->
        <nav id="mainNav" class="hidden sm:flex gap-6 text-base font-medium items-center">
          <a href="#" class="border-b-2 border-white pb-1">Faculty List</a>
          <a href="workdone-validation.html?role=HOD&department=" class="hover:underline" id="workdoneLink">Workdone Validation</a>
          <a href="workdone-edit-request.html" class="hover:underline text-green-400" id="editRequestLink">Edit Requests</a>
          <a href="#" onclick="openReportsModal(); return false;" class="hover:underline text-yellow-300" id="reportsLink">Reports</a>
          <a href="add-faculty.html" class="hover:underline">Add Faculty</a>
          <button onclick="openNotificationModal()" aria-label="Notifications" class="focus:outline-none">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-white hover:text-blue-400 transition">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3.75h6m-10.125 6.375V6.75A2.25 2.25 0 0 1 5.625 4.5h12.75a2.25 2.25 0 0 1 2.25 2.25v10.5a2.25 2.25 0 0 1-2.25 2.25H6.75l-4.5 4.5z" />
            </svg>
          </button>
          <button onclick="window.location.href='/logout'" aria-label="Logout" class="focus:outline-none">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-white hover:text-red-400 transition">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m-6-3h12m0 0l-3-3m3 3l-3 3" />
            </svg>
          </button>
        </nav>
      </div>
      <!-- Mobile nav links -->
      <div id="mobileNav" class="sm:hidden hidden px-4 pb-4">
        <nav class="flex flex-col gap-3 text-base font-medium bg-pmcPurple rounded shadow">
          <a href="#" class="border-b-2 border-white pb-1">Faculty List</a>
          <a href="workdone-validation.html?role=HOD&department=" class="hover:underline" id="workdoneLinkMobile">Workdone Validation</a>
          <a href="workdone-edit-request.html" class="hover:underline text-green-400" id="editRequestLinkMobile">Edit Requests</a>
          <a href="#" onclick="openReportsModal(); return false;" class="hover:underline text-yellow-300" id="reportsLinkMobile">Reports</a>
          <a href="add-faculty.html" class="hover:underline">Add Faculty</a>
          <button onclick="openNotificationModal()" aria-label="Notifications" class="focus:outline-none py-2 text-left">
            <span class="inline-flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-white hover:text-blue-400 transition">
                <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3.75h6m-10.125 6.375V6.75A2.25 2.25 0 0 1 5.625 4.5h12.75a2.25 2.25 0 0 1 2.25 2.25v10.5a2.25 2.25 0 0 1-2.25 2.25H6.75l-4.5 4.5z" />
              </svg>
              Notifications
            </span>
          </button>
          <button onclick="window.location.href='/logout'" aria-label="Logout" class="focus:outline-none py-2 text-left">
            <span class="inline-flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-white hover:text-red-400 transition">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m-6-3h12m0 0l-3-3m3 3l-3 3" />
              </svg>
              Logout
            </span>
          </button>
        </nav>
      </div>
      <script>
        // Toggle mobile nav
        document.addEventListener('DOMContentLoaded', function() {
          const menuBtn = document.getElementById('menuBtn');
          const mobileNav = document.getElementById('mobileNav');
          menuBtn.addEventListener('click', function() {
            mobileNav.classList.toggle('hidden');
          });
          // Set department in Workdone link for both desktop and mobile
          function getQueryParam(name) {
            const url = new URL(window.location.href);
            return url.searchParams.get(name);
          }
          var dept = getQueryParam('department');
          if (dept) {
            localStorage.setItem('department', dept);
          } else {
            dept = localStorage.getItem('department') || '';
          }
          var link = document.getElementById('workdoneLink');
          var linkMobile = document.getElementById('workdoneLinkMobile');
          var editLink = document.getElementById('editRequestLink');
          var editLinkMobile = document.getElementById('editRequestLinkMobile');
          if (link) {
            link.href = `workdone.html?role=HOD&department=${encodeURIComponent(dept)}`;
          }
          if (linkMobile) {
            linkMobile.href = `workdone.html?role=HOD&department=${encodeURIComponent(dept)}`;
          }
          if (editLink) {
            editLink.href = `workdone-edit-request.html?role=hod&department=${encodeURIComponent(dept)}`;
          }
          if (editLinkMobile) {
            editLinkMobile.href = `workdone-edit-request.html?role=hod&department=${encodeURIComponent(dept)}`;
          }
        });
      </script>
    </header>

    <!-- Reports Category Modal -->
    <div id="reportsModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 hidden">
      <div class="bg-white rounded-xl shadow-2xl w-full max-w-md p-6 relative transform transition-all">
        <button type="button" onclick="closeReportsModal()" class="absolute top-3 right-3 text-gray-400 hover:text-pmcPurple text-2xl font-bold">&times;</button>
        <h2 class="text-xl font-bold text-pmcPurple mb-6 flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
          </svg>
          Select Report Category
        </h2>
        <div class="space-y-4">
          <a href="#" id="reportAttendanceLink" class="block p-4 border-2 border-pmcPurple rounded-lg hover:bg-pmcPurple hover:text-white transition group">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 bg-pmcPurple text-white rounded-full flex items-center justify-center group-hover:bg-white group-hover:text-pmcPurple transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
                </svg>
              </div>
              <div>
                <h3 class="font-bold text-lg">Category 1: Attendance</h3>
                <p class="text-sm opacity-80">Students & Faculty Daily Attendance</p>
              </div>
            </div>
          </a>
          <a href="#" id="reportAcademicsLink" class="block p-4 border-2 border-blue-600 rounded-lg hover:bg-blue-600 hover:text-white transition group">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center group-hover:bg-white group-hover:text-blue-600 transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" />
                </svg>
              </div>
              <div>
                <h3 class="font-bold text-lg">Category 2: Academics</h3>
                <p class="text-sm opacity-80">Subject, Faculty & Topics Covered</p>
              </div>
            </div>
          </a>
          <a href="#" id="reportActivitiesLink" class="block p-4 border-2 border-green-600 rounded-lg hover:bg-green-600 hover:text-white transition group">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 bg-green-600 text-white rounded-full flex items-center justify-center group-hover:bg-white group-hover:text-green-600 transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
                </svg>
              </div>
              <div>
                <h3 class="font-bold text-lg">Category 3: Activities</h3>
                <p class="text-sm opacity-80">R&D, FDP, Training, Events & More</p>
              </div>
            </div>
          </a>
          <a href="#" id="reportAchievementsLink" class="block p-4 border-2 border-yellow-500 rounded-lg hover:bg-yellow-500 hover:text-white transition group">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 bg-yellow-500 text-white rounded-full flex items-center justify-center group-hover:bg-white group-hover:text-yellow-500 transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 18.75h-9m9 0a3 3 0 013 3h-15a3 3 0 013-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 01-.982-3.172M9.497 14.25a7.454 7.454 0 00.981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 007.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 002.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 012.916.52 6.003 6.003 0 01-5.395 4.972m0 0a6.726 6.726 0 01-2.749 1.35m0 0a6.772 6.772 0 01-3.044 0" />
                </svg>
              </div>
              <div>
                <h3 class="font-bold text-lg">Category 4: Achievements</h3>
                <p class="text-sm opacity-80">Positive Things & Challenges</p>
              </div>
            </div>
          </a>
          <a href="#" id="reportDisciplinaryLink" class="block p-4 border-2 border-red-500 rounded-lg hover:bg-red-500 hover:text-white transition group">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 bg-red-500 text-white rounded-full flex items-center justify-center group-hover:bg-white group-hover:text-red-500 transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                </svg>
              </div>
              <div>
                <h3 class="font-bold text-lg">Category 5: Disciplinary</h3>
                <p class="text-sm opacity-80">Student Disciplinary Actions</p>
              </div>
            </div>
          </a>
        </div>
        <!-- View My Reports Link -->
        <div class="mt-6 pt-4 border-t-2 border-gray-200">
          <a href="#" id="viewMyReportsLink" class="block p-4 bg-gradient-to-r from-pmcPurple to-purple-600 text-white rounded-lg hover:from-purple-700 hover:to-purple-800 transition shadow-lg">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-white text-pmcPurple rounded-full flex items-center justify-center">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                </div>
                <div>
                  <h3 class="font-bold text-lg">ðŸ“‹ View My Submitted Reports</h3>
                  <p class="text-sm opacity-90">View & Download as Image</p>
                </div>
              </div>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
              </svg>
            </div>
          </a>
        </div>
      </div>
    </div>

    <script>
      function openReportsModal() {
        const dept = localStorage.getItem('department') || '';
        document.getElementById('reportAttendanceLink').href = `reporting.html?department=${encodeURIComponent(dept)}`;
        document.getElementById('reportAcademicsLink').href = `reporting-academics.html?department=${encodeURIComponent(dept)}`;
        document.getElementById('reportActivitiesLink').href = `reporting-activities.html?department=${encodeURIComponent(dept)}`;
        document.getElementById('reportAchievementsLink').href = `reporting-achievements.html?department=${encodeURIComponent(dept)}`;
        document.getElementById('reportDisciplinaryLink').href = `reporting-disciplinary.html?department=${encodeURIComponent(dept)}`;
        document.getElementById('viewMyReportsLink').href = `hod-reports-dashboard.html?department=${encodeURIComponent(dept)}`;
        document.getElementById('reportsModal').classList.remove('hidden');
      }
      function closeReportsModal() {
        document.getElementById('reportsModal').classList.add('hidden');
      }
      // Close modal when clicking outside
      document.getElementById('reportsModal').addEventListener('click', function(e) {
        if (e.target === this) closeReportsModal();
      });
    </script>

    <!-- Supabase Notification Modal -->
    <div id="messagingModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
      <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6 relative">
        <button type="button" onclick="document.getElementById('messagingModal').classList.add('hidden')" class="absolute top-2 right-2 text-gray-400 hover:text-pmcPurple text-2xl font-bold">&times;</button>
        <h2 class="text-xl font-bold text-pmcPurple mb-4 flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 inline-block">
            <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a2.25 2.25 0 01-4.07 0M21 19.5a1.5 1.5 0 01-1.5-1.5V11a7.5 7.5 0 10-15 0v7a1.5 1.5 0 01-1.5 1.5h18z" />
          </svg>
          Notifications
        </h2>
        <div id="notificationList" class="h-48 overflow-y-auto border rounded p-2 mb-4 bg-gray-50"></div>
        <div class="flex gap-2">
          <input id="messageInput" type="text" class="flex-1 border border-pmcPurple rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pmcPurple text-black" placeholder="Type a notification..." onkeydown="if(event.key==='Enter'){postNotification()}" />
          <button onclick="postNotification()" class="bg-pmcPurple hover:bg-pmcPurpleDark text-white px-4 py-2 rounded font-semibold">Send</button>
        </div>
      </div>
    </div>
    <!-- Faculty List Content (inline, from faculty-list.html) -->
    <div class="max-w-6xl mx-auto mt-8 px-4">
      <!-- Department Display -->
      <h5 id="departmentName" class="text-lg font-semibold text-pmcPurple mb-4">
        Department: <span id="deptDisplay"></span>
      </h5>
      <!-- Link to HOD Dashboard -->
      <div class="mb-6">
        <a id="hodDashboardLink" href="#" class="bg-pmcPurple hover:bg-pmcPurpleDark text-white font-semibold px-6 py-2 rounded-lg shadow transition">Open HOD Dashboard</a>
      </div>
      <!-- Export Button -->
      <!-- View All Tables Button -->
      <!-- Search and Add Button -->
      <div
        class="flex flex-col md:flex-row items-center justify-between gap-4 mb-6"
      >
      
        <input
          id="facultySearch"
          type="text"
          class="p-3 border border-gray-300 rounded-md w-full max-w-md focus:outline-none focus:ring-2 focus:ring-pmcPurple"
          placeholder="Search faculty"
          oninput="filterFaculties()"
        />
        
        <a
          href="add-faculty.html"
          id="addFacultyBtn"
          class="bg-green-500 hover:bg-green-700 text-white font-semibold px-6 py-2 rounded-lg shadow transition whitespace-nowrap mt-2 md:mt-0"
          >+ Add Faculty</a
        >
        <script>
          function filterFaculties() {
            const search = document
              .getElementById("facultySearch")
              .value.toLowerCase();
            document.querySelectorAll(".faculty-card").forEach((card) => {
              const name = card
                .querySelector(".faculty-name")
                .textContent.toLowerCase();
              card.style.display = name.includes(search) ? "" : "none";
            });
          }
        </script>
        
      </div>
              <p class="text-gray-500 text-sm py-4">Note: All Faculty member kindly upload your profile.</p>

      <!-- Faculty Grid -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-6" id="facultyGrid">
        <!-- Faculty cards will be injected here by JS -->
      </div>
      <script src="https://unpkg.com/@supabase/supabase-js"></script>
      <script>
        // Only show HOD dashboard if ?as=hod is present, else redirect to hod-role.html
        function isHodAccess() {
          const params = new URLSearchParams(window.location.search);
          const asHod = params.get('as');
          const department = localStorage.getItem('department');
          const role = localStorage.getItem('role');
          return asHod === 'hod' && role === 'HOD' && department;
        }
  // Removed: if (!isHodAccess()) { window.location.replace('hod-role.html'); }
        // Get department from URL query parameter if present, else fallback to localStorage
        function getQueryParam(name) {
          const url = new URL(window.location.href);
          return url.searchParams.get(name);
        }
        const departmentParam = getQueryParam('department');
        const department = departmentParam || localStorage.getItem('department') || '';
        // Set department name in heading
        document.getElementById('deptDisplay').textContent = department;
        // Set HOD Dashboard link - check if S&H department
        const hodDashboardLink = document.getElementById('hodDashboardLink');
        if (hodDashboardLink) {
          // Check if department is S&H V1 to S&H V6
          const isSHDepartment = department.match(/^S&H V[1-6]$/i);
          const dashboardPage = isSHDepartment ? 'hod-dashboard-sh.html' : 'hod-dashboard.html';
          hodDashboardLink.href = `${dashboardPage}?department=${encodeURIComponent(department)}`;
        }
        // Supabase client
        const supabaseClient = window.supabase.createClient(
          "https://cbhodgwaazmjszkujrti.supabase.co",
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiaG9kZ3dhYXptanN6a3VqcnRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2NzY4NzEsImV4cCI6MjA3MTI1Mjg3MX0.sBRdfiWJJmZtLWsHCcNyxm1VcwkGwZWsIeeMlS49XTU"
        );
        async function loadFacultyList() {
          if (!department) {
            document.getElementById('facultyGrid').innerHTML = '<div class="col-span-4 text-gray-500">No department selected.</div>';
            return;
          }
          const { data, error } = await supabaseClient
            .from('Faculty')
            .select('*')
            .eq('department', department);
          if (error) {
            document.getElementById('facultyGrid').innerHTML = '<div class="col-span-4 text-red-500">Failed to load faculty list.</div>';
            return;
          }
          if (!data || data.length === 0) {
            document.getElementById('facultyGrid').innerHTML = '<div class="col-span-4 text-gray-500">No faculty found for this department.</div>';
            return;
          }
          document.getElementById('facultyGrid').innerHTML = data.map(faculty => `
            <div class="flex flex-col items-center bg-white rounded-xl shadow p-4 faculty-card">
              <a href="hod-viewfaculty-details.html?email=${encodeURIComponent(faculty['email'])}">
                <img src="${faculty['Upload Image'] || 'https://img.freepik.com/free-vector/blue-circle-with-white-user_78370-4707.jpg?semt=ais_hybrid&w=740&q=80'}" alt="Faculty" class="w-28 h-28 object-cover rounded-full shadow hover:scale-105 transition" />
              </a>
              <div class="faculty-name mt-3 font-medium text-pmcPurple">
                ${faculty['Name'] || 'Faculty'}
              </div>
              <div class="text-sm text-gray-500">${faculty['Designation'] || ''}</div>
            </div>
          `).join('');
        }
        loadFacultyList();
      </script>
      <script>
        // Fetch and display HOD name and profile image from HOD table for the current department
        async function setHodUsername() {
        // Get department from query param or localStorage
        function getQueryParam(name) {
          const url = new URL(window.location.href);
          return url.searchParams.get(name);
        }
        const departmentParam = getQueryParam('department');
        const department = departmentParam || localStorage.getItem('department') || '';
        const usernameSpan = document.getElementById('hodUsername');
        const profileImg = document.getElementById('hodProfileImg');
        if (!department) {
          usernameSpan.textContent = 'Username';
          profileImg.src = 'https://img.freepik.com/free-vector/blue-circle-with-white-user_78370-4707.jpg?semt=ais_hybrid&w=740&q=80';
          console.log('[HOD DEBUG] No department found in query param or localStorage.');
          return;
        }
        // Fetch Name and Upload Image from HOD table by department
        try {
          const { data, error } = await supabaseClient
            .from('HOD')
            .select('Name, "Upload Image"')
            .eq('department', department)
            .maybeSingle();
          console.log('[HOD DEBUG] Querying HOD table for department:', department);
          if (error) {
            console.error('[HOD DEBUG] Supabase error:', error);
          }
          console.log('[HOD DEBUG] HOD data:', data);
          if (data && data.Name) {
            usernameSpan.textContent = data.Name.trim() || 'Username';
            profileImg.src = data["Upload Image"] || 'https://img.freepik.com/free-vector/blue-circle-with-white-user_78370-4707.jpg?semt=ais_hybrid&w=740&q=80';
          } else {
            usernameSpan.textContent = 'Username';
            profileImg.src = 'https://img.freepik.com/free-vector/blue-circle-with-white-user_78370-4707.jpg?semt=ais_hybrid&w=740&q=80';
            console.warn('[HOD DEBUG] No HOD found for department:', department);
          }
        } catch (e) {
          console.error('[HOD DEBUG] Exception while fetching HOD:', e);
          usernameSpan.textContent = 'Username';
          profileImg.src = 'https://img.freepik.com/free-vector/blue-circle-with-white-user_78370-4707.jpg?semt=ais_hybrid&w=740&q=80';
        }
      }
      // Ensure HOD info loads as soon as DOM is ready
      document.addEventListener('DOMContentLoaded', setHodUsername);
      </script>
    </div>
    <!-- SheetJS (xlsx) CDN for Excel export -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script src="/static/javascript/supabase-notifications.js"></script>  <!-- Footer -->
  <footer class="text-center py-4 mt-8">
    <p class="text-sm">
      &copy; All Rights Reserved <a href="https://pmctech.org" target="_blank" class="underline">PMC TECH</a><br>
      <p class="text-xs opacity-80 flex items-center justify-center gap-2">
                        Powered by 
                        <a href="https://zeonytechnologies.com" target="_blank" rel="noopener noreferrer" class="inline-block hover:opacity-100 transition-all duration-300 hover:scale-105">
                            <img src="../static/img/zeony logo.png" alt="Zeony Technologies" class="h-12 w-22 py-2 object-contain"/>
                        </a><p class="text-xs opacity-80">A Student driven Software!</p>
    </p>
  </footer>

  </body>
  <!-- Remove old notification-system.js -->
</body>
  <!-- Supabase Notification Modal -->
  <div id="messagingModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
    <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6 relative">
      <button onclick="document.getElementById('messagingModal').classList.add('hidden')" class="absolute top-2 right-2 text-gray-400 hover:text-pmcPurple text-2xl font-bold">&times;</button>
      <h2 class="text-xl font-bold text-pmcPurple mb-4 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 inline-block">
          <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a2.25 2.25 0 01-4.07 0M21 19.5a1.5 1.5 0 01-1.5-1.5V11a7.5 7.5 0 10-15 0v7a1.5 1.5 0 01-1.5 1.5h18z" />
        </svg>
        Notifications
      </h2>
      <div id="notificationList" class="h-48 overflow-y-auto border rounded p-2 mb-4 bg-gray-50"></div>
      <div class="flex gap-2">
        <input id="messageInput" type="text" class="flex-1 border border-pmcPurple rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pmcPurple text-black" placeholder="Type a notification..." onkeydown="if(event.key==='Enter'){postNotification()}" />
        <button onclick="postNotification()" class="bg-pmcPurple hover:bg-pmcPurpleDark text-white px-4 py-2 rounded font-semibold">Send</button>
      </div>
    </div>
  </div>
</body>
</html>
